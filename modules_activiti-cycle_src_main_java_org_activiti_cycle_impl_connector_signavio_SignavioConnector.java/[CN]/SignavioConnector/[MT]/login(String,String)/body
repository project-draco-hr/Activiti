{
  if (!getConfigValue(CONFIG_KEY_LOGIN_REQUIRED,Boolean.class)) {
    return true;
  }
  String token=null;
  try {
    log.info("Logging into Signavio on url: " + getConfiguration().getLoginUrl());
    Form loginForm=new Form();
    loginForm.add("name",username);
    loginForm.add("password",password);
    loginForm.add("tokenonly","true");
    Representation loginRep=loginForm.getWebRepresentation();
    Request loginRequest=new Request(Method.POST,getConfiguration().getLoginUrl(),loginRep);
    Response loginResponse=sendRequestGetResponse(loginRequest);
    token=loginResponse.getEntity().getText();
    loginResponse.release();
  }
 catch (  Exception ex) {
    throw new RepositoryException("Error during login to connector '" + getName() + "'",ex);
  }
 finally {
    Engine.clearThreadLocalVariables();
  }
  if (token.matches("[a-f0-9]{32}")) {
    setSecurityToken(token);
    log.fine("SecurityToken: " + getSecurityToken());
  }
 else {
    Matcher matcher=Pattern.compile("<div id=\"warning\">([^<]+)</div>").matcher(token);
    if (matcher.find()) {
      String errorMessage=matcher.group(1);
      throw new RepositoryException(errorMessage);
    }
    throw new RepositoryException("No Security Token received. The user name and/or password might be incorrect.");
  }
  loggedIn=true;
  return true;
}
