{
  SqlSession sqlSession=sqlSessionFactory.openSession();
  boolean success=false;
  try {
    executeSchemaResource(directory,operation,databaseType,sqlSession);
    success=true;
  }
 catch (  Exception e) {
    throw new ActivitiException("couldn't create or drop db schema",e);
  }
 finally {
    if (success) {
      sqlSession.commit(true);
    }
 else {
      sqlSession.rollback(true);
    }
    sqlSession.close();
  }
  log.fine("activiti db schema " + operation + " successful");
}
