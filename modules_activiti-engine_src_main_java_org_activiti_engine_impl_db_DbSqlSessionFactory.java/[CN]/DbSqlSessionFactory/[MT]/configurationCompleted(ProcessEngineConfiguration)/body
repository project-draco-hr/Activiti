{
  this.databaseType=processEngineConfiguration.getDatabaseType();
  this.idGenerator=processEngineConfiguration.getIdGenerator();
  this.statementMappings=databaseSpecificStatements.get(processEngineConfiguration.getDatabaseType());
  DataSource dataSource=processEngineConfiguration.getDataSource();
  if (dataSource == null) {
    dataSource=createPooledDatasource(processEngineConfiguration);
  }
  TransactionFactory transactionFactory=null;
  if (processEngineConfiguration.isTransactionsExternallyManaged()) {
    transactionFactory=new ManagedTransactionFactory();
  }
 else {
    transactionFactory=new JdbcTransactionFactory();
  }
  this.sqlSessionFactory=createSessionFactory(dataSource,transactionFactory);
}
