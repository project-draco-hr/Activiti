{
  ProcessInstance procInst=runtimeService.startProcessInstanceByKey("suspendProcess");
  assertNotNull(procInst);
  assertEquals(1,managementService.createJobQuery().processInstanceId(procInst.getId()).count());
  boolean wasJobExecutorActive=processEngineConfiguration.getJobExecutor().isActive();
  if (wasJobExecutorActive) {
    processEngineConfiguration.getJobExecutor().shutdown();
  }
  Calendar tomorrow=Calendar.getInstance();
  tomorrow.add(Calendar.DAY_OF_YEAR,1);
  ClockUtil.setCurrentTime(tomorrow.getTime());
  CommandExecutor commandExecutor=processEngineConfiguration.getCommandExecutorTxRequired();
  List<TimerEntity> jobs=commandExecutor.execute(new GetUnlockedTimersByDuedateCmd(ClockUtil.getCurrentTime(),new Page(0,1)));
  assertEquals(1,jobs.size());
  runtimeService.suspendProcessInstanceById(procInst.getId());
  jobs=commandExecutor.execute(new GetUnlockedTimersByDuedateCmd(ClockUtil.getCurrentTime(),new Page(0,1)));
  assertEquals(0,jobs.size());
  if (wasJobExecutorActive) {
    processEngineConfiguration.getJobExecutor().start();
  }
}
