{
  if (processEngine == null) {
    processEngine=processEngines.get(configurationResource);
    if (processEngine == null) {
      log.fine("==== BUILDING PROCESS ENGINE ========================================================================");
      processEngine=new ProcessEngineBuilder().configureFromPropertiesResource(configurationResource).buildProcessEngine();
      log.fine("==== PROCESS ENGINE CREATED =========================================================================");
      processEngines.put(configurationResource,processEngine);
    }
    initializeServices();
  }
  log.severe(EMPTY_LINE);
  try {
    annotationDeploymentBefore();
    super.runTest();
  }
 catch (  AssertionFailedError e) {
    log.severe(EMPTY_LINE);
    log.log(Level.SEVERE,"ASSERTION FAILED: " + e,e);
    exception=e;
    throw e;
  }
catch (  Throwable e) {
    log.severe(EMPTY_LINE);
    log.log(Level.SEVERE,"EXCEPTION: " + e,e);
    exception=e;
    throw e;
  }
 finally {
    annotationDeploymentAfter();
    assertAndEnsureCleanDb();
    ClockUtil.reset();
  }
}
