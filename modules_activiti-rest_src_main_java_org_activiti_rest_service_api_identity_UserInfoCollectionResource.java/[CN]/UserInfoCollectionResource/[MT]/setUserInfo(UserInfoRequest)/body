{
  if (!authenticate())   return null;
  User user=getUserFromRequest();
  if (request.getKey() == null) {
    throw new ActivitiIllegalArgumentException("The key cannot be null.");
  }
  if (request.getValue() == null) {
    throw new ActivitiIllegalArgumentException("The value cannot be null.");
  }
  String existingValue=ActivitiUtil.getIdentityService().getUserInfo(user.getId(),request.getKey());
  if (existingValue != null) {
    throw new ResourceException(Status.CLIENT_ERROR_CONFLICT.getCode(),"User info with key '" + request.getKey() + "' already exists for this user.",null,null);
  }
  ActivitiUtil.getIdentityService().setUserInfo(user.getId(),request.getKey(),request.getValue());
  setStatus(Status.SUCCESS_CREATED);
  return getApplication(ActivitiRestServicesApplication.class).getRestResponseFactory().createUserInfoResponse(this,request.getKey(),request.getValue(),user.getId());
}
