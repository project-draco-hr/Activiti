{
  ProcessInstance processInstance=runtimeService.startProcessInstanceByKey("oneTaskProcess");
  assertNotNull(processInstance);
  listener.clearEventsReceived();
  runtimeService.deleteProcessInstance(processInstance.getId(),"delete_test");
  List<ActivitiEvent> processCancelledEvents=listener.filterEvents(ActivitiEventType.PROCESS_CANCELLED);
  assertEquals("ActivitiEventType.PROCESS_CANCELLED was expected 1 time.",1,processCancelledEvents.size());
  assertTrue("The cause has to be the same as deleteProcessInstance method call",ActivitiCancelledEvent.class.isAssignableFrom(processCancelledEvents.get(0).getClass()));
  assertEquals("The process instance has to be the same as in deleteProcessInstance method call",processInstance.getId(),processCancelledEvents.get(0).getProcessInstanceId());
  assertEquals("The execution instance has to be the same as in deleteProcessInstance method call",processInstance.getId(),processCancelledEvents.get(0).getExecutionId());
  assertEquals("The cause has to be the same as in deleteProcessInstance method call","delete_test",((ActivitiCancelledEvent)processCancelledEvents.get(0)).getCause());
  listener.clearEventsReceived();
}
