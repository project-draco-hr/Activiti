{
  if (processInstance == null) {
    String state=null;
    try {
      Field field=target.getClass().getDeclaredField(stateFieldName);
      field.setAccessible(true);
      state=(String)field.get(target);
    }
 catch (    Exception e) {
      throw new ActivitiException("couldn't get field " + stateFieldName,e);
    }
    processInstance=new ExecutionImpl((ProcessDefinitionImpl)processDefinition);
    ActivityImpl activity=processDefinition.getActivity(state);
    processInstance.setActivity(activity);
  }
}
