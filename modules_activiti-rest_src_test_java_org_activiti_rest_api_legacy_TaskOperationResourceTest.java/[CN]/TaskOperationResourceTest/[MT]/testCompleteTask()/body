{
  ProcessInstance instance=runtimeService.startProcessInstanceByKey("simpleProcess");
  Task task=taskService.createTaskQuery().singleResult();
  assertNotNull(task);
  assertEquals("WaitTask",task.getName());
  ClientResource client=getAuthenticatedClient("task/" + task.getId() + "/complete");
  ObjectNode varNode=objectMapper.createObjectNode();
  varNode.put("myVar","test");
  Representation response=client.put(varNode);
  JsonNode responseNode=objectMapper.readTree(response.getStream());
  assertNotNull(responseNode);
  assertTrue(responseNode.get("success").getBooleanValue());
  task=taskService.createTaskQuery().singleResult();
  assertNotNull(task);
  assertEquals("AnotherTask",task.getName());
  Object varValue=runtimeService.getVariable(instance.getId(),"myVar");
  assertNotNull(varValue);
  assertEquals("test",varValue);
  taskService.complete(task.getId());
  List<ProcessInstance> instanceList=runtimeService.createProcessInstanceQuery().list();
  assertEquals(0,instanceList.size());
}
