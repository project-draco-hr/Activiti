{
  if (task == null) {
    boolean isOwner=historyService.createHistoricTaskInstanceQuery().taskId(taskId).taskOwner(loggedInUserId).finished().count() == 1;
    if (isOwner) {
      viewManager.showArchivedPage(taskId);
    }
 else {
      showNavigationError(taskId);
    }
  }
 else   if (loggedInUserId.equals(task.getOwner())) {
    viewManager.showCasesPage(task.getId());
  }
 else   if (loggedInUserId.equals(task.getAssignee())) {
    viewManager.showInboxPage(task.getId());
  }
 else {
    boolean pageFound=false;
    boolean userInvolved=taskService.createTaskQuery().taskInvolvedUser(loggedInUserId).count() == 1;
    if (userInvolved) {
      viewManager.showInvolvedPage(task.getId());
      pageFound=true;
    }
 else {
      List<String> groupIds=getGroupIds(loggedInUserId);
      List<IdentityLink> identityLinks=taskService.getIdentityLinksForTask(task.getId());
      Iterator<IdentityLink> identityLinkIterator=identityLinks.iterator();
      while (!pageFound && identityLinkIterator.hasNext()) {
        IdentityLink identityLink=identityLinkIterator.next();
        if (identityLink.getGroupId() != null && groupIds.contains(identityLink.getGroupId())) {
          viewManager.showQueuedPage(identityLink.getGroupId(),task.getId());
          pageFound=true;
        }
      }
    }
    if (!pageFound) {
      showNavigationError(taskId);
    }
  }
}
