{
  if (Context.getCommandContext() != null) {
    ExecutionEntity processInstance=Context.getExecutionContext().getProcessInstance();
    if (processInstance != null) {
      return processInstance;
    }
  }
  Execution execution=getExecution();
  if (execution != null) {
    return processEngine.getRuntimeService().createProcessInstanceQuery().processInstanceId(execution.getProcessInstanceId()).singleResult();
  }
  return null;
}
