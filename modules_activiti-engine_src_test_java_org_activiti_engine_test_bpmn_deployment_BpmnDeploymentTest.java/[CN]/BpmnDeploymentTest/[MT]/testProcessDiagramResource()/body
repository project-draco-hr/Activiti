{
  String processDefinitionId=repositoryService.createProcessDefinitionQuery().singleResult().getId();
  ReadOnlyProcessDefinition processDefinition=((RepositoryServiceImpl)repositoryService).getDeployedProcessDefinition(processDefinitionId);
  String diagramResourceName=processDefinition.getDiagramResourceName();
  assertEquals("org/activiti/engine/test/bpmn/deployment/BpmnDeploymentTest.testProcessDiagramResource.jpg",diagramResourceName);
  InputStream diagramStream=repositoryService.getResourceAsStream(deploymentId,"org/activiti/engine/test/bpmn/deployment/BpmnDeploymentTest.testProcessDiagramResource.jpg");
  byte[] diagramBytes=IoUtil.readInputStream(diagramStream,"diagram stream");
  assertEquals(33343,diagramBytes.length);
}
