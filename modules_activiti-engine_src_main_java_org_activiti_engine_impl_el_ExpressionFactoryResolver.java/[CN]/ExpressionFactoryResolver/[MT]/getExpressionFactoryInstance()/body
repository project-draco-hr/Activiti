{
  ClassLoader classLoader=getClassLoader();
  String serviceId="META-INF/services/" + ExpressionFactory.class.getName();
  String implClassName=getFactoryClassNameFromClasspath(classLoader,serviceId);
  if (implClassName == null) {
    implClassName=getFactoryClassNameFromJVM();
    if (implClassName == null) {
      implClassName=getFactoryClassNameFromSystemProps();
    }
  }
  if (implClassName == null) {
    LOG.fine("No ExpressionFactory classname could be resolved, reverting to default: " + DEFAULT_EXPRESSION_FACTORY_CLASSNAME);
    implClassName=DEFAULT_EXPRESSION_FACTORY_CLASSNAME;
  }
  return newInstance(implClassName,classLoader);
}
