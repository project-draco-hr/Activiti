{
  ActivityImpl activity=execution.getActivity();
  ProcessDefinitionImpl processDefinition=execution.getProcessDefinition();
  if (activity == processDefinition.getInitial()) {
    execution.performOperation(ACTIVITY_EXECUTE);
  }
 else {
    List<ActivityImpl> initialActivityStack=processDefinition.getInitialActivityStack();
    if (activity == null) {
      activity=initialActivityStack.get(0);
    }
 else {
      int index=initialActivityStack.indexOf(activity);
      activity=initialActivityStack.get(index + 1);
    }
    ExecutionImpl executionToUse=null;
    if (activity.isScope()) {
      executionToUse=execution.getExecutions().get(0);
    }
 else {
      executionToUse=execution;
    }
    executionToUse.setActivity(activity);
    executionToUse.performOperation(PROCESS_START);
  }
}
