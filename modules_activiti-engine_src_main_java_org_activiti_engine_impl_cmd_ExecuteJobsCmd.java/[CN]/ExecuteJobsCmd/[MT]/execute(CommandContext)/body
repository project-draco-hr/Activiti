{
  if (jobId == null) {
    throw new ActivitiException("jobId is null");
  }
  if (log.isLoggable(Level.FINE)) {
    log.fine("Executing job " + jobId);
  }
  JobEntity job=commandContext.getJobManager().findJobById(jobId);
  if (job == null) {
    throw new ActivitiException("No job found with id '" + jobId + "'");
  }
  JobExecutorContext jobExecutorContext=Context.getJobExecutorContext();
  if (jobExecutorContext != null) {
    jobExecutorContext.setCurrentJob(job);
  }
  try {
    job.execute(commandContext);
  }
 catch (  RuntimeException exception) {
    CommandExecutor commandExecutor=Context.getProcessEngineConfiguration().getCommandExecutorTxRequiresNew();
    commandContext.getTransactionContext().addTransactionListener(TransactionState.ROLLED_BACK,new FailedJobListener(commandExecutor,jobId,exception));
    throw exception;
  }
 finally {
    if (jobExecutorContext != null) {
      jobExecutorContext.setCurrentJob(null);
    }
  }
  return null;
}
