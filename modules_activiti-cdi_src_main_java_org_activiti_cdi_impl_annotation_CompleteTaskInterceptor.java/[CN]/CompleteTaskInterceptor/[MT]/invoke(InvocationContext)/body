{
  try {
    Object result=ctx.proceed();
    CompleteTask completeTaskAnnotation=ctx.getMethod().getAnnotation(CompleteTask.class);
    String taskKey=completeTaskAnnotation.value();
    String taskName=completeTaskAnnotation.name();
    boolean endConversation=completeTaskAnnotation.endConversation();
    Task task=null;
    if (taskName.length() > 0) {
      task=taskService.createTaskQuery().processInstanceId(businessProcess.getProcessInstanceId()).taskName(taskName).taskAssignee(actor.getActorId()).singleResult();
    }
 else     if (taskKey.length() > 0) {
      task=taskService.createTaskQuery().processInstanceId(businessProcess.getProcessInstanceId()).taskDefinitionKey(taskKey).taskAssignee(actor.getActorId()).singleResult();
    }
 else {
      task=taskService.createTaskQuery().processInstanceId(businessProcess.getProcessInstanceId()).taskAssignee(actor.getActorId()).singleResult();
    }
    businessProcess.resumeTaskById(task.getId());
    businessProcess.completeTask();
    if (endConversation) {
      if (!conversation.isUnsatisfied()) {
        conversation.get().end();
      }
    }
    return result;
  }
 catch (  InvocationTargetException e) {
    throw e.getCause();
  }
}
