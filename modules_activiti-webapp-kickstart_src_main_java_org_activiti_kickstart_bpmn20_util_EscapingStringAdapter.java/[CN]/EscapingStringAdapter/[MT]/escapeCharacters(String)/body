{
  if (string == null) {
    return string;
  }
  StringBuffer copyBuffer=null;
  boolean copied=false;
  for (int i=0; i < string.length(); i++) {
    if (isIllegal(string.charAt(i))) {
      if (!copied) {
        copyBuffer=new StringBuffer(string);
        copied=true;
      }
      copyBuffer.deleteCharAt(i);
    }
  }
  return copied ? copyBuffer.toString() : string;
}
