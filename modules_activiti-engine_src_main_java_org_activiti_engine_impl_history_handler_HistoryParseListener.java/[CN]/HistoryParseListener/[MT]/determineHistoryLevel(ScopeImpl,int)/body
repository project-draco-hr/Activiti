{
  ProcessDefinitionImpl processDefinition=scopeElement.getProcessDefinition();
  if (processDefinition != null) {
    Integer processHistoryLevel=((ProcessDefinitionEntity)processDefinition).getHistoryLevel();
    if (processHistoryLevel != null) {
      return Math.min(historyLevel,((ProcessDefinitionEntity)scopeElement.getProcessDefinition()).getHistoryLevel());
    }
  }
  return historyLevel;
}
