{
  for (int i=1; i <= 3; i++) {
    ProcessInstance pi=runtimeService.startProcessInstanceByKey("inclusiveGwDiverging",CollectionUtil.singletonMap("input",i));
    List<Task> tasks=taskService.createTaskQuery().processInstanceId(pi.getId()).list();
    Map<String,String> expectedNames=new HashMap<String,String>();
    if (i == 1) {
      expectedNames.put(TASK1_NAME,TASK1_NAME);
    }
    if (i <= 2) {
      expectedNames.put(TASK2_NAME,TASK2_NAME);
    }
    expectedNames.put(TASK3_NAME,TASK3_NAME);
    assertEquals(4 - i,tasks.size());
    for (    Task task : tasks) {
      expectedNames.remove(task.getName());
    }
    assertEquals(0,expectedNames.size());
    runtimeService.deleteProcessInstance(pi.getId(),"testing deletion");
  }
}
