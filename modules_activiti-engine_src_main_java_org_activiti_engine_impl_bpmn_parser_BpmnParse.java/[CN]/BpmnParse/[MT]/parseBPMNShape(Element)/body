{
  String bpmnElement=bpmnShapeElement.attribute("bpmnElement");
  if (bpmnElement != null && !"".equals(bpmnElement)) {
    if (participantProcesses.get(bpmnElement) != null) {
      ProcessDefinitionEntity procDef=getProcessDefinition(participantProcesses.get(bpmnElement));
      procDef.setGraphicalNotationDefined(true);
      parseDIBounds(bpmnShapeElement,procDef.getParticipantProcess());
      return;
    }
    for (    ProcessDefinitionEntity processDefinition : getProcessDefinitions()) {
      ActivityImpl activity=processDefinition.findActivity(bpmnElement);
      if (activity != null) {
        parseDIBounds(bpmnShapeElement,activity);
        String isExpanded=bpmnShapeElement.attribute("isExpanded");
        if (isExpanded != null) {
          activity.setProperty(PROPERTYNAME_ISEXPANDED,parseBooleanAttribute(isExpanded));
        }
      }
 else {
        Lane lane=processDefinition.getLaneForId(bpmnElement);
        if (lane != null) {
          parseDIBounds(bpmnShapeElement,lane);
        }
 else         if (!elementIds.contains(bpmnElement)) {
          addError("Invalid reference in 'bpmnElement' attribute, activity " + bpmnElement + "not found",bpmnShapeElement);
        }
      }
    }
  }
 else {
    addError("'bpmnElement' attribute is required on BPMNShape",bpmnShapeElement);
  }
}
