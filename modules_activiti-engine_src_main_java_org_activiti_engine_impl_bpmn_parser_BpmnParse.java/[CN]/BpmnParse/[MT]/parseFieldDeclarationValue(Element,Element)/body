{
  ActivitiValueExpression valueExpression=null;
  try {
    String stringValue=fieldDeclarationElement.attributeNS(BpmnParser.BPMN_EXTENSIONS_NS,"string-value");
    Element stringElement=fieldDeclarationElement.elementNS(BpmnParser.BPMN_EXTENSIONS_NS,"string");
    String stringElementText=null;
    if (stringElement != null) {
      stringElementText=stringElement.getText();
      if (stringValue != null && (stringElementText != null || stringElementText.length() > 0)) {
        addError("Invalid: both string-value and a text are provided",stringElement);
      }
 else       if (stringValue == null && (stringElementText == null || stringElementText.length() == 0)) {
        addError("Invalid declartion: no string-value or string element text provided",fieldDeclarationElement);
      }
    }
    valueExpression=expressionManager.createValueExpression(stringValue != null ? stringValue : stringElementText);
  }
 catch (  ActivitiException e) {
    if (e.getMessage().contains("multiple elements with tag name")) {
      addError("Invalid: multiple field declarations found",serviceTaskElement);
    }
 else {
      addError("Error when paring field declarations: " + e.getMessage(),serviceTaskElement);
    }
  }
  return valueExpression;
}
