{
  ActivityImpl activity=createActivityOnScope(sendTaskElement,scope);
  String type=sendTaskElement.attributeNS(BpmnParser.ACTIVITI_BPMN_EXTENSIONS_NS,"type");
  String implementation=sendTaskElement.attribute("implementation");
  String operationRef=this.resolveName(sendTaskElement.attribute("operationRef"));
  if (type != null) {
    if (type.equalsIgnoreCase("mail")) {
      parseEmailServiceTask(activity,sendTaskElement,parseFieldDeclarations(sendTaskElement));
    }
 else {
      addError("Invalid usage of type attribute: '" + type + "'",sendTaskElement);
    }
  }
 else   if (implementation != null && operationRef != null && implementation.equalsIgnoreCase("##WebService")) {
    if (!this.operations.containsKey(operationRef)) {
      addError(operationRef + " does not exist",sendTaskElement);
    }
 else {
      Operation operation=this.operations.get(operationRef);
      WebServiceActivityBehavior webServiceActivityBehavior=new WebServiceActivityBehavior(operation);
      Element ioSpecificationElement=sendTaskElement.element("ioSpecification");
      if (ioSpecificationElement != null) {
        IOSpecification ioSpecification=this.parseIOSpecification(ioSpecificationElement);
        webServiceActivityBehavior.setIoSpecification(ioSpecification);
      }
      for (      Element dataAssociationElement : sendTaskElement.elements("dataInputAssociation")) {
        AbstractDataAssociation dataAssociation=this.parseDataInputAssociation(dataAssociationElement);
        webServiceActivityBehavior.addDataInputAssociation(dataAssociation);
      }
      for (      Element dataAssociationElement : sendTaskElement.elements("dataOutputAssociation")) {
        AbstractDataAssociation dataAssociation=this.parseDataOutputAssociation(dataAssociationElement);
        webServiceActivityBehavior.addDataOutputAssociation(dataAssociation);
      }
      activity.setActivityBehavior(webServiceActivityBehavior);
    }
  }
 else {
    addError("One of the attributes 'type' or 'operation' is mandatory on sendTask.",sendTaskElement);
  }
  parseExecutionListenersOnScope(sendTaskElement,activity);
  for (  BpmnParseListener parseListener : parseListeners) {
    parseListener.parseSendTask(sendTaskElement,scope,activity);
  }
  return activity;
}
