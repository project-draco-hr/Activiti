{
  List<ProcessDefinitionEntity> processDefinitions=new ArrayList<ProcessDefinitionEntity>();
  Map<String,ResourceEntity> resources=deployment.getResources();
  for (  String resourceName : resources.keySet()) {
    LOG.info("Processing resource " + resourceName);
    if (resourceName.endsWith(BPMN_RESOURCE_SUFFIX)) {
      ResourceEntity resource=resources.get(resourceName);
      byte[] bytes=resource.getBytes();
      ByteArrayInputStream inputStream=new ByteArrayInputStream(bytes);
      BpmnParse bpmnParse=new BpmnParser(expressionManager).createParse().sourceInputStream(inputStream).name(resourceName).execute();
      processDefinitions.addAll(bpmnParse.getProcessDefinitions());
    }
  }
  return processDefinitions;
}
