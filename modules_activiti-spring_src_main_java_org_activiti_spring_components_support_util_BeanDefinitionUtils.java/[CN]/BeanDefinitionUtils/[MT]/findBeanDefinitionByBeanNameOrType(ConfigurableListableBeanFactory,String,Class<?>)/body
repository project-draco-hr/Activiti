{
  String[] existingBeans=configurableListableBeanFactory.getBeanNamesForType(type,true,true);
  Assert.isTrue(existingBeans.length > 0,"there must be at least one bean for the type " + type);
  String beanIdToReturn=null;
  if (StringUtils.hasText(possibleBeanName)) {
    for (    String existingBean : existingBeans) {
      if (existingBean.equals(possibleBeanName)) {
        beanIdToReturn=existingBean;
      }
    }
  }
 else {
    if (existingBeans.length == 1) {
      beanIdToReturn=existingBeans[0];
    }
  }
  return beanIdToReturn == null ? null : configurableListableBeanFactory.getBeanDefinition(beanIdToReturn);
}
