{
  String deploymentName="Process " + adhocWorkflow.getName();
  String bpmn20XmlResourceName=generateBpmnResourceName(adhocWorkflow.getName());
  DeploymentBuilder deploymentBuilder=repositoryService.createDeployment().name(deploymentName);
  ProcessDiagramGenerator converter=new ProcessDiagramGenerator(adhocWorkflow);
  deploymentBuilder.addInputStream(bpmn20XmlResourceName.replace(".bpmn20.xml",".png"),converter.execute());
  deploymentBuilder.addString(bpmn20XmlResourceName,createBpmn20Xml(adhocWorkflow));
  Deployment deployment=deploymentBuilder.deploy();
  return deployment.getId();
}
