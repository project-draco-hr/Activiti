{
  ActivityImpl terminateEndEventActivity=(ActivityImpl)execution.getActivity();
  if (terminateAll) {
    ActivityExecution processInstanceExecution=findProcessInstanceExecution(execution);
    terminateProcessInstanceExecution(execution,terminateEndEventActivity,processInstanceExecution);
  }
 else {
    ActivityExecution scopeExecution=ScopeUtil.findScopeExecution(execution);
    terminateExecution(execution,terminateEndEventActivity,scopeExecution);
  }
}
