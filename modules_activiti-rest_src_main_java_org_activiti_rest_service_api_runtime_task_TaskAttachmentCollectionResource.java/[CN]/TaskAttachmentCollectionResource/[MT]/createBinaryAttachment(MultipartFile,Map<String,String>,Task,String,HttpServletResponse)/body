{
  String name=null;
  String description=null;
  String type=null;
  if (requestParams.containsKey("name")) {
    name=requestParams.get("name");
  }
 else   if (requestParams.containsKey("description")) {
    description=requestParams.get("description");
  }
 else   if (requestParams.containsKey("type")) {
    type=requestParams.get("type");
  }
  if (name == null) {
    throw new ActivitiIllegalArgumentException("Attachment name is required.");
  }
  if (file == null) {
    throw new ActivitiIllegalArgumentException("Attachment content is required.");
  }
  try {
    Attachment createdAttachment=taskService.createAttachment(type,task.getId(),task.getProcessInstanceId(),name,description,file.getInputStream());
    response.setStatus(HttpStatus.SC_CREATED);
    return restResponseFactory.createAttachmentResponse(createdAttachment,serverRootUrl);
  }
 catch (  Exception e) {
    throw new ActivitiException("Error creating attachment response",e);
  }
}
