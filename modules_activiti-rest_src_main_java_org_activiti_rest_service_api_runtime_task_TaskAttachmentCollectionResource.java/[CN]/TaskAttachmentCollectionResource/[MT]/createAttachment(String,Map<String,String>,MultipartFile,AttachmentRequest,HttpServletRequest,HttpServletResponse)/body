{
  String serverRootUrl=request.getRequestURL().toString();
  serverRootUrl=serverRootUrl.substring(0,serverRootUrl.indexOf("/runtime/tasks/"));
  AttachmentResponse result=null;
  Task task=getTaskFromRequest(taskId);
  if (file != null) {
    result=createBinaryAttachment(file,allRequestParams,task,serverRootUrl,response);
  }
 else {
    result=createSimpleAttachment(attachmentRequest,task,serverRootUrl);
  }
  response.setStatus(HttpStatus.SC_CREATED);
  return result;
}
