{
  Object newItemId=null;
  if (itemId == null) {
    newItemId=addItem();
  }
 else {
    newItemId=addItemAfter(itemId);
  }
  Item newItem=getItem(newItemId);
  newItem.getItemProperty("property").setValue(propertyName == null ? "My Property" : propertyName);
  ComboBox typeComboBox=new ComboBox("types",Arrays.asList("text","number","date"));
  typeComboBox.setNullSelectionAllowed(false);
  if (propertyType == null) {
    typeComboBox.setValue(typeComboBox.getItemIds().iterator().next());
  }
 else {
    typeComboBox.setValue(propertyType);
  }
  newItem.getItemProperty("type").setValue(typeComboBox);
  CheckBox requiredCheckBox=new CheckBox();
  requiredCheckBox.setValue(required == null ? false : required);
  newItem.getItemProperty("required").setValue(requiredCheckBox);
  HorizontalLayout actionButtons=new HorizontalLayout();
  Button deleteRowButton=new Button("-");
  deleteRowButton.setData(newItemId);
  deleteRowButton.addListener(new DeletePropertyClickListener(this));
  actionButtons.addComponent(deleteRowButton);
  Button addRowButton=new Button("+");
  addRowButton.setData(newItemId);
  addRowButton.addListener(new AddPropertyClickListener(this));
  actionButtons.addComponent(addRowButton);
  newItem.getItemProperty("actions").setValue(actionButtons);
}
