{
  try {
    if (authenticate() == false)     return null;
    String startParams=entity.getText();
    JsonNode startJSON=new ObjectMapper().readTree(startParams);
    String processDefinitionKey=startJSON.path("processDefinitionKey").getTextValue();
    String processDefinitionId=null;
    if (processDefinitionKey == null) {
      processDefinitionId=startJSON.path("processDefinitionId").getTextValue();
    }
    JsonNode businessKeyJson=startJSON.path("businessKey");
    String businessKey=null;
    if (businessKeyJson != null) {
      businessKey=businessKeyJson.getTextValue();
    }
    Map<String,Object> variables=retrieveVariables(startJSON);
    variables.remove("processDefinitionId");
    variables.remove("processDefinitionKey");
    variables.remove("businessKey");
    ProcessInstance processInstance=null;
    if (processDefinitionKey != null) {
      processInstance=ActivitiUtil.getRuntimeService().startProcessInstanceByKey(processDefinitionKey,businessKey,variables);
    }
 else {
      processInstance=ActivitiUtil.getRuntimeService().startProcessInstanceById(processDefinitionId,businessKey,variables);
    }
    StartProcessInstanceResponse response=new StartProcessInstanceResponse(processInstance);
    return response;
  }
 catch (  Exception e) {
    throw new ActivitiException("Failed to retrieve the process definition parameters",e);
  }
}
