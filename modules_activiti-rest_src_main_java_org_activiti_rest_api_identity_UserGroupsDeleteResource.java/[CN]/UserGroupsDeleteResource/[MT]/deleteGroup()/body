{
  if (authenticate() == false)   return null;
  String userId=(String)getRequest().getAttributes().get("userId");
  String groupId=(String)getRequest().getAttributes().get("groupId");
  if (userId == null) {
    setStatus(Status.CLIENT_ERROR_BAD_REQUEST,"No userId provided.");
    return new StateResponse().setSuccess(false);
  }
  if (groupId == null) {
    setStatus(Status.CLIENT_ERROR_BAD_REQUEST,"No groupId provided.");
    return new StateResponse().setSuccess(false);
  }
  IdentityService identityService=ActivitiUtil.getIdentityService();
  if (identityService.createUserQuery().userId(userId).singleResult() == null) {
    setStatus(Status.CLIENT_ERROR_NOT_FOUND,"The user '" + userId + "' does not exist.");
    return new StateResponse().setSuccess(false);
  }
  Group group=identityService.createGroupQuery().groupMember(userId).groupId(groupId).singleResult();
  if (group != null)   identityService.deleteMembership(userId,groupId);
  return new StateResponse().setSuccess(true);
}
