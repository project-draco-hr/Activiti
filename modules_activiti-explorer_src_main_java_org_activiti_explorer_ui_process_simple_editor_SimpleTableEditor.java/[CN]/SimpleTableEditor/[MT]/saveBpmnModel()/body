{
  WorkflowDefinition workflowDefinition=createWorkflow();
  RepositoryService repositoryService=ProcessEngines.getDefaultProcessEngine().getRepositoryService();
  Model model=repositoryService.newModel();
  model.setName(workflowDefinition.getName());
  repositoryService.saveModel(model);
  WorkflowDefinitionConversion conversion=ExplorerApp.get().getWorkflowDefinitionConversionFactory().createWorkflowDefinitionConversion(workflowDefinition);
  conversion.convert();
  BpmnXMLConverter bpmnXMLConverter=new BpmnXMLConverter();
  System.out.println("IN --- > " + new String(bpmnXMLConverter.convertToXML(conversion.getBpmnModel())));
  try {
    BpmnJsonConverter bpmnJsonConverter=new BpmnJsonConverter();
    ObjectNode json=bpmnJsonConverter.convertToJson(conversion.getBpmnModel());
    System.out.println("JSON ---> " + json.toString());
    repositoryService.addModelEditorSource(model.getId(),json.toString().getBytes("utf-8"));
    repositoryService.addModelEditorSourceExtra(model.getId(),IOUtils.toByteArray(conversion.getWorkflowDiagramImage()));
  }
 catch (  IOException e) {
    logger.warn("Could not generate process image. Image is not stored and will not be shown.",e);
  }
  ExplorerApp.get().getViewManager().showEditorProcessDefinitionPage(model.getId());
}
