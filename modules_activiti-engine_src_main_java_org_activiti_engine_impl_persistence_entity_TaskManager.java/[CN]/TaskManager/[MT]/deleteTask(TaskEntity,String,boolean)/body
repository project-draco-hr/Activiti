{
  if (!task.isDeleted()) {
    task.setDeleted(true);
    CommandContext commandContext=Context.getCommandContext();
    String taskId=task.getId();
    commandContext.getIdentityLinkManager().deleteIdentityLinksByTaskId(taskId);
    commandContext.getVariableInstanceManager().deleteVariableInstanceByTaskId(taskId);
    commandContext.getHistoricTaskInstanceManager().markTaskInstanceEnded(taskId,deleteReason);
    getPersistenceSession().delete(TaskEntity.class,task.getId());
  }
}
