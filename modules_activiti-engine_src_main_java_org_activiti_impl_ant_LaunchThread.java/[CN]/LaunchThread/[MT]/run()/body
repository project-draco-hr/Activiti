{
  task.log("launching cmd '" + cmdString(cmd) + "' in dir '"+ dir+ "'");
  if (msg != null) {
    task.log("waiting for launch completion msg '" + msg + "'...");
  }
 else {
    task.log("not waiting for a launch completion msg.");
  }
  ProcessBuilder processBuilder=new ProcessBuilder(cmd).redirectErrorStream(true).directory(dir);
  try {
    Process process=processBuilder.start();
    InputStream consoleStream=process.getInputStream();
    BufferedReader consoleReader=new BufferedReader(new InputStreamReader(consoleStream));
    String consoleLine="";
    while ((consoleLine != null) && (msg == null || consoleLine.indexOf(msg) == -1)) {
      consoleLine=consoleReader.readLine();
      if (consoleLine != null) {
        task.log("  " + consoleLine);
      }
 else {
        task.log("launched process completed");
      }
    }
  }
 catch (  Exception e) {
    throw new BuildException("couldn't launch " + cmdString(cmd),e);
  }
}
