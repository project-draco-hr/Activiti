{
  ZipOutputStream zipfile=null;
  try {
    ByteArrayOutputStream bos=new ByteArrayOutputStream();
    zipfile=new ZipOutputStream(bos);
    for (    String fileName : files.keySet()) {
      ZipEntry zipentry=new ZipEntry(fileName);
      zipfile.putNextEntry(zipentry);
      zipfile.write(files.get(fileName));
    }
    zipfile.flush();
    bos.flush();
    zipfile.close();
    return bos.toByteArray();
  }
 catch (  Exception e) {
    throw new ActivitiException("Couldn't create zip file",e);
  }
}
