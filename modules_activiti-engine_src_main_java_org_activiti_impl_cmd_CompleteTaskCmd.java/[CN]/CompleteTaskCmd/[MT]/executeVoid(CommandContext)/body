{
  PersistenceSession persistenceSession=commandContext.getPersistenceSession();
  TaskImpl task=persistenceSession.findTask(taskId);
  if (variables != null) {
    task.setExecutionVariables(variables);
  }
  if (task == null) {
    throw new ActivitiException("Cannot find task with id " + taskId);
  }
  task.delete();
  ExecutionImpl execution=task.getExecution();
  if (execution != null) {
    execution.event(null);
  }
}
