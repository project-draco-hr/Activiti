{
  RuntimeSession runtimeSession=commandContext.getPersistenceSession();
  TaskEntity task=runtimeSession.findTask(taskId);
  if (variables != null) {
    task.setExecutionVariables(variables);
  }
  if (task == null) {
    throw new ActivitiException("Cannot find task with id " + taskId);
  }
  task.delete();
  PvmActivityInstance activityInstance=task.getActivityInstance();
  if (activityInstance != null) {
    activityInstance.signal(null,null);
  }
}
