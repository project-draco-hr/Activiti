{
  if (restVariable.getName() == null) {
    throw new ActivitiIllegalArgumentException("Variable name is required");
  }
  RestVariableScope scope=restVariable.getVariableScope();
  if (scope == null) {
    scope=RestVariableScope.LOCAL;
  }
  Object actualVariableValue=getApplication(ActivitiRestServicesApplication.class).getRestResponseFactory().getVariableValue(restVariable);
  setVariable(task,restVariable.getName(),actualVariableValue,scope,isNew);
  RestResponseFactory responseFactory=getApplication(ActivitiRestServicesApplication.class).getRestResponseFactory();
  return responseFactory.createRestVariable(this,restVariable.getName(),actualVariableValue,scope,task.getId(),RestResponseFactory.VARIABLE_TASK,false);
}
