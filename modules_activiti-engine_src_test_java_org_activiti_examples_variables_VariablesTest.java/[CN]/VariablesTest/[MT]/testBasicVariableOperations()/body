{
  Date now=new Date();
  List<String> serializable=new ArrayList<String>();
  serializable.add("one");
  serializable.add("two");
  serializable.add("three");
  byte[] bytes="somebytes".getBytes();
  Map<String,Object> variables=new HashMap<String,Object>();
  variables.put("cost center",928374L);
  variables.put("customer","coca-cola");
  variables.put("message","<xml />");
  variables.put("start date",now);
  variables.put("nihil",null);
  variables.put("numbers",serializable);
  variables.put("manybits",bytes);
  ProcessInstance processInstance=runtimeService.startProcessInstanceByKey("taskAssigneeProcess",variables);
  variables=runtimeService.getVariables(processInstance.getId());
  assertEquals(928374L,variables.get("cost center"));
  assertEquals("coca-cola",variables.get("customer"));
  assertEquals("<xml />",variables.get("message"));
  assertEquals(now,variables.get("start date"));
  assertEquals(null,variables.get("nihil"));
  assertEquals(serializable,variables.get("numbers"));
  assertTrue(Arrays.equals(bytes,(byte[])variables.get("manybits")));
  assertEquals(7,variables.size());
  runtimeService.setVariable(processInstance.getId(),"cost center",null);
  runtimeService.setVariable(processInstance.getId(),"customer",null);
  runtimeService.setVariable(processInstance.getId(),"message",null);
  runtimeService.setVariable(processInstance.getId(),"start date",null);
  runtimeService.setVariable(processInstance.getId(),"nihil",null);
  runtimeService.setVariable(processInstance.getId(),"numbers",null);
  runtimeService.setVariable(processInstance.getId(),"manybits",null);
  variables=runtimeService.getVariables(processInstance.getId());
  assertEquals(null,variables.get("cost center"));
  assertEquals(null,variables.get("customer"));
  assertEquals(null,variables.get("message"));
  assertEquals(null,variables.get("start date"));
  assertEquals(null,variables.get("nihil"));
  assertEquals(null,variables.get("numbers"));
  assertEquals(null,variables.get("manybits"));
  assertEquals(7,variables.size());
  runtimeService.setVariable(processInstance.getId(),"new var","hi");
  runtimeService.setVariable(processInstance.getId(),"cost center",9987L);
  runtimeService.setVariable(processInstance.getId(),"customer","colgate");
  runtimeService.setVariable(processInstance.getId(),"message","{json}");
  runtimeService.setVariable(processInstance.getId(),"start date",now);
  runtimeService.setVariable(processInstance.getId(),"numbers",serializable);
  runtimeService.setVariable(processInstance.getId(),"manybits",bytes);
  variables=runtimeService.getVariables(processInstance.getId());
  assertEquals("hi",variables.get("new var"));
  assertEquals(9987L,variables.get("cost center"));
  assertEquals("colgate",variables.get("customer"));
  assertEquals("{json}",variables.get("message"));
  assertEquals(now,variables.get("start date"));
  assertEquals(null,variables.get("nihil"));
  assertEquals(serializable,variables.get("numbers"));
  assertTrue(Arrays.equals(bytes,(byte[])variables.get("manybits")));
  assertEquals(8,variables.size());
}
