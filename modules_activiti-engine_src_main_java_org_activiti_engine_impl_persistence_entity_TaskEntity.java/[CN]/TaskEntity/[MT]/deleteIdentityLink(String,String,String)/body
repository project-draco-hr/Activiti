{
  List<IdentityLinkEntity> identityLinks=Context.getCommandContext().getIdentityLinkEntityManager().findIdentityLinkByTaskUserGroupAndType(id,userId,groupId,type);
  for (  IdentityLinkEntity identityLink : identityLinks) {
    Context.getCommandContext().getIdentityLinkEntityManager().deleteIdentityLink(identityLink,true);
  }
  List<IdentityLinkEntity> removedIdentityLinkEntities=new ArrayList<IdentityLinkEntity>();
  for (  IdentityLinkEntity identityLinkEntity : this.getIdentityLinks()) {
    if (IdentityLinkType.CANDIDATE.equals(identityLinkEntity.getType())) {
      if ((userId != null && userId.equals(identityLinkEntity.getUserId())) || (groupId != null && identityLinkEntity.getGroupId().equals(groupId))) {
        Context.getCommandContext().getIdentityLinkEntityManager().deleteIdentityLink(identityLinkEntity,true);
        removedIdentityLinkEntities.add(identityLinkEntity);
      }
    }
  }
  getIdentityLinks().removeAll(removedIdentityLinkEntities);
}
