{
  Map<RepositoryArtifact,RepositoryArtifact> resultList=null;
  try {
    ZipInputStream projectTemplateInputStream=new ZipInputStream(getProjectTemplate());
    ZipEntry zipEntry=null;
    while ((zipEntry=projectTemplateInputStream.getNextEntry()) != null) {
      String zipName=zipEntry.getName();
      zipName=zipName.replaceAll("activiti-cycle-maven-template/","");
      if (zipName.endsWith("/")) {
        zipName=zipName.substring(0,zipName.length() - 1);
      }
      String path="";
      String name=zipName;
      if (zipName.contains("/")) {
        path=zipName.substring(0,zipName.lastIndexOf("/"));
        name=zipName.substring(zipName.lastIndexOf("/") + 1);
      }
      String absolutePath=rootFolderId + "/" + path;
      if (zipEntry.isDirectory()) {
        if (!zipEntry.getName().equals("activiti-cycle-maven-template/")) {
          connector.createFolder(absolutePath,name);
        }
      }
 else {
        if ("template.bpmn20.xml".equals(name)) {
          resultList=generateProcesses(processes,absolutePath,connector);
        }
 else {
          Content content=new Content();
          byte[] bytes=IoUtil.readInputStream(projectTemplateInputStream,"ZIP entry '" + zipName + "'");
          String txtContent=new String(bytes).replaceAll(REPLACE_STRING,projectName).replaceAll("@@ACTIVITI.HOME@@",ACTIVITI_HOME_PATH);
          content.setValue(txtContent);
          log.log(Level.INFO,"Create new artifact from zip entry '" + zipEntry.getName() + "' in folder '"+ absolutePath+ "' with name '"+ name+ "'");
          connector.createArtifact(absolutePath,name,null,content);
        }
      }
      projectTemplateInputStream.closeEntry();
    }
    projectTemplateInputStream.close();
  }
 catch (  IOException ex) {
    throw new RepositoryException("Couldn't create maven project due to IO errors",ex);
  }
  return resultList;
}
