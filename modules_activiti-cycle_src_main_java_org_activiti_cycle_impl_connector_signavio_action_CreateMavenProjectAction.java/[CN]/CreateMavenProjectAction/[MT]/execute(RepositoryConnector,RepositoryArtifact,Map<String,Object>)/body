{
  String targetFolderId=(String)getParameter(parameters,PARAM_TARGET_FOLDER,true,null,String.class);
  String targetName=(String)getParameter(parameters,PARAM_TARGET_NAME,false,getProcessName(artifact),String.class);
  String comment=(String)getParameter(parameters,PARAM_COMMENT,false,null,String.class);
  RepositoryConnector targetConnector=(RepositoryConnector)getParameter(parameters,PARAM_TARGET_CONNECTOR,true,null,RepositoryConnector.class);
  boolean createLink=(Boolean)getParameter(parameters,CREATE_LINK_NAME,true,Boolean.TRUE,Boolean.class);
  String bpmnXml=ActivitiCompliantBpmn20Provider.createBpmnXml(connector,artifact);
  RepositoryArtifact bpmnArtifact=null;
  TransactionalConnectorUtils.beginTransaction(targetConnector);
  try {
    bpmnArtifact=createProject(targetConnector,targetFolderId,targetName,bpmnXml);
    TransactionalConnectorUtils.commitTransaction(targetConnector,comment);
  }
 catch (  RepositoryException e) {
    TransactionalConnectorUtils.rollbackTransaction(targetConnector);
    throw e;
  }
  if (createLink && bpmnArtifact != null) {
    RepositoryArtifactLink link=new RepositoryArtifactLinkEntity();
    link.setSourceArtifact(artifact);
    link.setTargetArtifact(bpmnArtifact);
    link.setComment(comment);
    link.setLinkType(getLinkType());
    connector.getConfiguration().getCycleService().addArtifactLink(link);
  }
}
