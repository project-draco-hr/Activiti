{
  if (authenticate() == false)   return null;
  Execution execution=getExecutionFromRequest();
  List<RestVariable> result=new ArrayList<RestVariable>();
  Map<String,RestVariable> variableMap=new HashMap<String,RestVariable>();
  RestVariableScope variableScope=RestVariable.getScopeFromString(getQueryParameter("scope",getQuery()));
  if (variableScope == null) {
    addLocalVariables(execution,variableMap);
    addGlobalVariables(execution,variableMap);
  }
 else   if (variableScope == RestVariableScope.GLOBAL) {
    addGlobalVariables(execution,variableMap);
  }
 else   if (variableScope == RestVariableScope.LOCAL) {
    addLocalVariables(execution,variableMap);
  }
  result.addAll(variableMap.values());
  return result;
}
