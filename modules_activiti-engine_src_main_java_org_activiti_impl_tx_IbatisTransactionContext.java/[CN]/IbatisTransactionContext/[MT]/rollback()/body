{
  try {
    try {
      log.fine("firing event rolling back...");
      fireTransactionEvent(TransactionState.ROLLINGBACK);
    }
 catch (    Throwable exception) {
      log.info("Exception during transaction: " + exception.getMessage());
      commandContext.exception(exception);
    }
 finally {
      log.fine("rolling back ibatis sql session...");
      getPersistenceSession().rollback();
    }
  }
 catch (  Throwable exception) {
    log.info("Exception during transaction: " + exception.getMessage());
    commandContext.exception(exception);
  }
 finally {
    log.fine("firing event rolled back...");
    fireTransactionEvent(TransactionState.ROLLED_BACK);
  }
}
