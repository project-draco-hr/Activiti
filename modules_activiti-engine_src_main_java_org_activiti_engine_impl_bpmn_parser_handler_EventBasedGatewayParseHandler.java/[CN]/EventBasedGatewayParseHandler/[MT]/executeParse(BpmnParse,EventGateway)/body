{
  ActivityImpl activity=createActivityOnCurrentScope(bpmnParse,gateway,BpmnXMLConstants.ELEMENT_GATEWAY_EVENT);
  activity.setActivityBehavior(bpmnParse.getActivityBehaviorFactory().createEventBasedGatewayActivityBehavior(gateway));
  activity.setScope(true);
  BpmnModel bpmnModel=bpmnParse.getBpmnModel();
  for (  SequenceFlow sequenceFlow : gateway.getOutgoingFlows()) {
    FlowElement flowElement=bpmnModel.getFlowElement(sequenceFlow.getTargetRef());
    if (flowElement != null && flowElement instanceof IntermediateCatchEvent == false) {
      bpmnModel.addProblem("Event based gateway can only be connected to elements of type intermediateCatchEvent.",flowElement);
    }
  }
}
