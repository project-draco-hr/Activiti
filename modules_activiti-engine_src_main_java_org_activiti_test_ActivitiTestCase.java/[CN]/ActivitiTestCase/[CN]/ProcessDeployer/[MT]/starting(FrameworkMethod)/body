{
  processEngine=processEngineBuilder.getProcessEngine();
  processService=processEngine.getProcessService();
  taskService=processEngine.getTaskService();
  identityService=processEngine.getIdentityService();
  managementService=processEngine.getManagementService();
  ProcessDeclared process=method.getAnnotation(ProcessDeclared.class);
  if (process != null) {
    String[] resources=process.resources();
    resources=resources.length == 0 ? process.value() : resources;
    if (resources.length == 0) {
      String name=method.getName();
      String resource=getBpmnProcessDefinitionResource(method.getMethod().getDeclaringClass(),name);
      log.fine("deploying bpmn process resource: " + resource);
      deployProcessResource(resource);
    }
 else {
      DeploymentBuilder builder=processEngine.getProcessService().createDeployment();
      for (      String resource : resources) {
        if (resource.startsWith("/")) {
          resource=resource.substring(1);
        }
 else {
          resource=getProcessDefinitionResource(method.getMethod().getDeclaringClass(),resource);
        }
        builder.addClasspathResource(resource);
      }
      Deployment deployment=builder.deploy();
      registerDeployment(deployment.getId());
    }
  }
}
