{
  processEngineConfiguration.setTransactionsExternallyManaged(transactionManager != null);
  if (transactionManager != null) {
    List<CommandInterceptor> commandInterceptorsTxRequired=new ArrayList<CommandInterceptor>();
    commandInterceptorsTxRequired.add(new LogInterceptor());
    commandInterceptorsTxRequired.add(new JtaTransactionInterceptor(transactionManager,false));
    commandInterceptorsTxRequired.add(new CommandContextInterceptor());
    commandInterceptorsTxRequired.add(new CommandExecutorImpl());
    processEngineConfiguration.setCommandInterceptorsTxRequired(commandInterceptorsTxRequired);
    List<CommandInterceptor> commandInterceptorsTxRequiresNew=new ArrayList<CommandInterceptor>();
    commandInterceptorsTxRequiresNew.add(new LogInterceptor());
    commandInterceptorsTxRequiresNew.add(new JtaTransactionInterceptor(transactionManager,true));
    commandInterceptorsTxRequiresNew.add(new CommandContextInterceptor());
    commandInterceptorsTxRequiresNew.add(new CommandExecutorImpl());
    processEngineConfiguration.setCommandInterceptorsTxRequiresNew(commandInterceptorsTxRequiresNew);
  }
}
