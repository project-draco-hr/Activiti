{
  ProcessInstance processInstance=deployer.getProcessService().startProcessInstanceByKey("callSimpleSubProcess");
  TaskQuery taskQuery=deployer.getTaskService().createTaskQuery();
  Task taskBeforeSubProcess=taskQuery.singleResult();
  assertEquals("Task before subprocess",taskBeforeSubProcess.getName());
  deployer.getTaskService().complete(taskBeforeSubProcess.getId());
  Task taskInSubProcess=taskQuery.singleResult();
  assertEquals("Task in subprocess",taskInSubProcess.getName());
  deployer.getTaskService().complete(taskInSubProcess.getId());
  Task taskAfterSubProcess=taskQuery.singleResult();
  assertEquals("Task after subprocess",taskAfterSubProcess.getName());
  deployer.getTaskService().complete(taskAfterSubProcess.getId());
  deployer.assertProcessEnded(processInstance.getId());
}
