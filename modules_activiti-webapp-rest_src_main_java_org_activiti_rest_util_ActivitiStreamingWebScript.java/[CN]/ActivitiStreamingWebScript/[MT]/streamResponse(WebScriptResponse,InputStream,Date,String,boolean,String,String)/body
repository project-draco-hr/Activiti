{
  if (attach) {
    String headerValue="attachment";
    if (attachFileName != null && attachFileName.length() > 0) {
      headerValue+="; filename=" + attachFileName;
    }
    res.setHeader("Content-Disposition",headerValue);
  }
  if (mimetype != null) {
    res.setContentType(mimetype);
  }
  Cache cache=new Cache();
  cache.setNeverCache(false);
  cache.setMustRevalidate(true);
  cache.setMaxAge(0L);
  cache.setLastModified(modified);
  if (eTag != null) {
    cache.setETag(eTag);
  }
  res.setCache(cache);
  try {
    byte[] buffer=new byte[0xFFFF];
    for (int len; (len=inputStream.read(buffer)) != -1; )     res.getOutputStream().write(buffer,0,len);
  }
 catch (  SocketException e) {
  }
}
