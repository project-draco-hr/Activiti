{
  if (!authenticate()) {
    return null;
  }
  Form urlQuery=getQuery();
  HistoricProcessInstanceQueryRequest queryRequest=new HistoricProcessInstanceQueryRequest();
  if (getQueryParameter("processInstanceId",urlQuery) != null) {
    queryRequest.setProcessInstanceId(getQueryParameter("processInstanceId",urlQuery));
  }
  if (getQueryParameter("processDefinitionKey",urlQuery) != null) {
    queryRequest.setProcessDefinitionKey(getQueryParameter("processDefinitionKey",urlQuery));
  }
  if (getQueryParameter("processDefinitionId",urlQuery) != null) {
    queryRequest.setProcessDefinitionId(getQueryParameter("processDefinitionId",urlQuery));
  }
  if (getQueryParameter("businessKey",urlQuery) != null) {
    queryRequest.setProcessBusinessKey(getQueryParameter("businessKey",urlQuery));
  }
  if (getQueryParameter("involvedUser",urlQuery) != null) {
    queryRequest.setInvolvedUser(getQueryParameter("involvedUser",urlQuery));
  }
  if (getQueryParameter("finished",urlQuery) != null) {
    queryRequest.setFinished(getQueryParameterAsBoolean("finished",urlQuery));
  }
  if (getQueryParameter("superProcessInstanceId",urlQuery) != null) {
    queryRequest.setSuperProcessInstanceId(getQueryParameter("superProcessInstanceId",urlQuery));
  }
  if (getQueryParameter("finishedAfter",urlQuery) != null) {
    queryRequest.setFinishedAfter(getQueryParameterAsDate("finishedAfter",urlQuery));
  }
  if (getQueryParameter("finishedBefore",urlQuery) != null) {
    queryRequest.setFinishedBefore(getQueryParameterAsDate("finishedBefore",urlQuery));
  }
  if (getQueryParameter("startedAfter",urlQuery) != null) {
    queryRequest.setStartedAfter(getQueryParameterAsDate("startedAfter",urlQuery));
  }
  if (getQueryParameter("startedBefore",urlQuery) != null) {
    queryRequest.setStartedBefore(getQueryParameterAsDate("startedBefore",urlQuery));
  }
  if (getQueryParameter("startedBy",urlQuery) != null) {
    queryRequest.setStartedBy(getQueryParameter("startedBy",urlQuery));
  }
  if (getQueryParameter("includeProcessVariables",urlQuery) != null) {
    queryRequest.setIncludeProcessVariables(getQueryParameterAsBoolean("includeProcessVariables",urlQuery));
  }
  return getQueryResponse(queryRequest,urlQuery);
}
