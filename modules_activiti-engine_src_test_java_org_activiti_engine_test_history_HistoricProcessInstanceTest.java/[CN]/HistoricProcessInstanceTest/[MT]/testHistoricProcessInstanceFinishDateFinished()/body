{
  ProcessInstance pi=runtimeService.startProcessInstanceByKey("oneTaskProcess");
  Date date=new Date();
  runtimeService.deleteProcessInstance(pi.getId(),"cancel");
  assertEquals(1,historyService.createHistoricProcessInstanceQuery().finishDateOn(date).count());
  assertEquals(1,historyService.createHistoricProcessInstanceQuery().finishDateBy(date).count());
  assertEquals(1,historyService.createHistoricProcessInstanceQuery().finishDateBy(DateUtils.addDays(date,1)).count());
  assertEquals(0,historyService.createHistoricProcessInstanceQuery().finishDateBy(DateUtils.addDays(date,-1)).count());
  assertEquals(0,historyService.createHistoricProcessInstanceQuery().finishDateOn(DateUtils.addDays(date,-1)).count());
  assertEquals(0,historyService.createHistoricProcessInstanceQuery().finishDateOn(DateUtils.addDays(date,1)).count());
}
