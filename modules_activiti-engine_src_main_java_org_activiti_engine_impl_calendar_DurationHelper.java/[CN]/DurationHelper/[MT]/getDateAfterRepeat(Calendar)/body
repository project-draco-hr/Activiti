{
  if (start != null) {
    Calendar cur=TimeZoneUtil.convertToTimeZone(start,date.getTimeZone());
    for (int i=0; i < times && !cur.after(date); i++) {
      cur=add(cur,period);
    }
    return cur.before(date) ? date : TimeZoneUtil.convertToTimeZone(cur,clockReader.getCurrentTimeZone());
  }
  Calendar cur=add(TimeZoneUtil.convertToTimeZone(end,date.getTimeZone()),period.negate());
  Calendar next=TimeZoneUtil.convertToTimeZone(end,date.getTimeZone());
  for (int i=0; i < times && cur.after(date); i++) {
    next=cur;
    cur=add(cur,period.negate());
  }
  return next.before(date) ? date : TimeZoneUtil.convertToTimeZone(next,clockReader.getCurrentTimeZone());
}
