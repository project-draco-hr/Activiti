{
  if (start != null) {
    Calendar cur=ClockUtil.convertToTimeZone(start,date.getTimeZone());
    for (int i=0; i < times && !cur.after(date); i++) {
      cur=add(cur,period);
    }
    return cur.before(date) ? null : ClockUtil.convertToTimeZone(cur,ClockUtil.getCurrentTimeZone());
  }
  Calendar cur=add(ClockUtil.convertToTimeZone(end,date.getTimeZone()),period.negate());
  Calendar next=ClockUtil.convertToTimeZone(end,date.getTimeZone());
  for (int i=0; i < times && cur.after(date); i++) {
    next=cur;
    cur=add(cur,period.negate());
  }
  return next.before(date) ? null : ClockUtil.convertToTimeZone(next,ClockUtil.getCurrentTimeZone());
}
