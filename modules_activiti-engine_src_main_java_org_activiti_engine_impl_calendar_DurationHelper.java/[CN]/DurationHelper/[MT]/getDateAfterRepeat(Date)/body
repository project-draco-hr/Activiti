{
  if (start != null) {
    Date cur=start;
    for (int i=0; i < times && !cur.after(date); i++) {
      cur=add(cur,period);
    }
    return cur.before(date) ? null : cur;
  }
  Date cur=add(end,period.negate());
  Date next=end;
  for (int i=0; i < times && cur.after(date); i++) {
    next=cur;
    cur=add(cur,period.negate());
  }
  return next.before(date) ? null : next;
}
