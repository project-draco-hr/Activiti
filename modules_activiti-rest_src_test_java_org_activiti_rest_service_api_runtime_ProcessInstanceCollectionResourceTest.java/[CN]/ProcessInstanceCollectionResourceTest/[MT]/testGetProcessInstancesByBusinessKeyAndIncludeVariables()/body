{
  HashMap<String,Object> variables=new HashMap<String,Object>();
  variables.put("myVar1","myVar1");
  ProcessInstance processInstance=runtimeService.startProcessInstanceByKey("processOne","myBusinessKey",variables);
  String processId=processInstance.getId();
  String url=RestUrls.createRelativeResourceUrl(RestUrls.URL_PROCESS_INSTANCE_COLLECTION) + "?businessKey=myBusinessKey";
  HttpResponse response=executeHttpRequest(new HttpGet(SERVER_URL_PREFIX + url),HttpStatus.SC_OK);
  JsonNode rootNode=objectMapper.readTree(response.getEntity().getContent());
  assertTrue(rootNode.size() > 0);
  assertEquals(1,rootNode.get("data").size());
  JsonNode dataNode=rootNode.get("data").get(0);
  assertEquals(processId,dataNode.get("id").asText());
  assertEquals(processInstance.getProcessDefinitionId(),dataNode.get("processDefinitionId").asText());
  assertTrue(dataNode.get("processDefinitionUrl").asText().contains(processInstance.getProcessDefinitionId()));
  JsonNode variableNodes=dataNode.get("variables");
  assertEquals(0,variableNodes.size());
  url=RestUrls.createRelativeResourceUrl(RestUrls.URL_PROCESS_INSTANCE_COLLECTION) + "?businessKey=myBusinessKey&includeProcessVariables=true";
  response=executeHttpRequest(new HttpGet(SERVER_URL_PREFIX + url),HttpStatus.SC_OK);
  rootNode=objectMapper.readTree(response.getEntity().getContent());
  assertTrue(rootNode.size() > 0);
  assertEquals(1,rootNode.get("data").size());
  dataNode=rootNode.get("data").get(0);
  assertEquals(processId,dataNode.get("id").textValue());
  assertEquals(processInstance.getProcessDefinitionId(),dataNode.get("processDefinitionId").asText());
  assertTrue(dataNode.get("processDefinitionUrl").asText().contains(processInstance.getProcessDefinitionId()));
  variableNodes=dataNode.get("variables");
  assertEquals(1,variableNodes.size());
  variableNodes=dataNode.get("variables");
  assertEquals(variableNodes.size(),1);
  assertNotNull(variableNodes.get(0).get("name"));
  assertNotNull(variableNodes.get(0).get("value"));
  assertEquals("myVar1",variableNodes.get(0).get("name").asText());
  assertEquals("myVar1",variableNodes.get(0).get("value").asText());
}
