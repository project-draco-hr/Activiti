{
  ObjectNode modelNode=null;
  String modelId=(String)getRequest().getAttributes().get("modelId");
  if (NumberUtils.isNumber(modelId)) {
    ModelDao modelDao=new ModelDao();
    ModelData model=modelDao.getModelById(Long.valueOf(modelId));
    if (model != null) {
      try {
        modelNode=(ObjectNode)objectMapper.readTree(model.getModelJson());
        modelNode.put(MODEL_ID,model.getObjectId());
        ObjectNode editorJsonNode=(ObjectNode)objectMapper.readTree(model.getModelEditorJson());
        modelNode.put("model",editorJsonNode);
      }
 catch (      Exception e) {
        LOGGER.log(Level.SEVERE,"Error creating model JSON",e);
        setStatus(Status.SERVER_ERROR_INTERNAL);
      }
    }
  }
  return modelNode;
}
