{
  String deploymentId1=deployStartSignalTestProcess();
  List<EventSubscriptionEntity> eventSubscriptions=getAllEventSubscriptions();
  assertEquals(1,eventSubscriptions.size());
  assertTrue(eventSubscriptions.get(0).isLatest());
  String deploymentId2=deployStartSignalTestProcess();
  eventSubscriptions=getAllEventSubscriptions();
  assertEquals(2,eventSubscriptions.size());
  assertEventSubscriptionLatestCount(1);
  repositoryService.deleteDeployment(deploymentId2,true);
  eventSubscriptions=getAllEventSubscriptions();
  assertEquals(1,eventSubscriptions.size());
  assertTrue(eventSubscriptions.get(0).isLatest());
  cleanup(deploymentId1);
  assertEquals(0,getAllEventSubscriptions().size());
  deploymentId1=deployStartSignalTestProcess();
  deploymentId2=deployStartSignalTestProcess();
  assertEquals(2,getAllEventSubscriptions().size());
  repositoryService.deleteDeployment(deploymentId1,true);
  eventSubscriptions=getAllEventSubscriptions();
  assertEquals(1,eventSubscriptions.size());
  assertTrue(eventSubscriptions.get(0).isLatest());
  assertEquals(repositoryService.createProcessDefinitionQuery().deploymentId(deploymentId2).singleResult().getId(),eventSubscriptions.get(0).getProcessDefinitionId());
  cleanup(deploymentId2);
  assertEquals(0,getAllEventSubscriptions().size());
}
