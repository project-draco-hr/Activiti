{
  ProcessDefinitionImpl processDefinition=processDefinitions.get(processDefinitionId);
  if (processDefinition == null) {
    CommandContext commandContext=CommandContext.getCurrent();
    PersistenceSession persistenceSession=commandContext.getPersistenceSession();
    DeploymentImpl deployment=persistenceSession.findDeploymentByProcessDefinitionId(processDefinitionId);
    if (deployment != null) {
      deployerManager.deploy(deployment,commandContext);
    }
  }
  processDefinition=processDefinitions.get(processDefinitionId);
  if (processDefinition != null) {
    return processDefinition;
  }
 else {
    throw new ActivitiException("Couldn't find process definiton with id " + processDefinitionId);
  }
}
