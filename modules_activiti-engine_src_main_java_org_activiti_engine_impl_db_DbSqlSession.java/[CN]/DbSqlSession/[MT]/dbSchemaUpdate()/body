{
  String feedback=null;
  String dbVersion=null;
  boolean isUpgradeNeeded=false;
  if (isEngineTablePresent()) {
    PropertyEntity dbVersionProperty=selectById(PropertyEntity.class,"schema.version");
    dbVersion=dbVersionProperty.getValue();
    isUpgradeNeeded=isUpgradeNeeded(dbVersion);
    if (isUpgradeNeeded) {
      dbVersionProperty.setValue(ProcessEngine.VERSION);
      PropertyEntity dbHistoryProperty;
      if ("5.0".equals(dbVersion)) {
        dbHistoryProperty=new PropertyEntity("schema.history","create(5.0)");
        insert(dbHistoryProperty);
      }
 else {
        dbHistoryProperty=selectById(PropertyEntity.class,"schema.history");
      }
      String dbHistoryValue=dbHistoryProperty.getValue() + " upgrade(" + dbVersion+ "->"+ ProcessEngine.VERSION+ ")";
      dbHistoryProperty.setValue(dbHistoryValue);
      dbSchemaUpgrade("engine",dbVersion);
      feedback="upgraded Activiti from " + dbVersion + " to "+ ProcessEngine.VERSION;
    }
  }
 else {
    dbSchemaCreateEngine();
  }
  return feedback;
}
