{
  int historyLevel=Context.getProcessEngineConfiguration().getHistoryLevel();
  ExecutionEntity execution=task.getExecution();
  if (historyLevel >= ProcessEngineConfigurationImpl.HISTORYLEVEL_AUDIT && execution != null) {
    DbSqlSession dbSqlSession=commandContext.getSession(DbSqlSession.class);
    for (    String propertyId : properties.keySet()) {
      String propertyValue=properties.get(propertyId);
      HistoricFormPropertyEntity historicFormProperty=new HistoricFormPropertyEntity(execution,propertyId,propertyValue,taskId);
      dbSqlSession.insert(historicFormProperty);
    }
  }
  TaskFormHandler taskFormHandler=task.getTaskDefinition().getTaskFormHandler();
  taskFormHandler.submitFormProperties(properties,task.getExecution());
  task.complete();
  return null;
}
