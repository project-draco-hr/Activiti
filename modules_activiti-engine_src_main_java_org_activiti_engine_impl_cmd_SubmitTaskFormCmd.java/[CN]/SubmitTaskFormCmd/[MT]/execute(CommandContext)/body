{
  if (taskId == null) {
    throw new ActivitiException("taskId is null");
  }
  TaskEntity task=commandContext.getTaskManager().findTaskById(taskId);
  if (task == null) {
    throw new ActivitiException("Cannot find task with id " + taskId);
  }
  ExecutionEntity execution=task.getExecution();
  if (commandContext.getHistoryManager().isHistoryLevelAtLeast(HistoryLevel.AUDIT) && execution != null) {
    DbSqlSession dbSqlSession=commandContext.getSession(DbSqlSession.class);
    for (    String propertyId : properties.keySet()) {
      String propertyValue=properties.get(propertyId);
      HistoricFormPropertyEntity historicFormProperty=new HistoricFormPropertyEntity(execution,propertyId,propertyValue,taskId);
      dbSqlSession.insert(historicFormProperty);
    }
  }
  TaskFormHandler taskFormHandler=task.getTaskDefinition().getTaskFormHandler();
  taskFormHandler.submitFormProperties(properties,task.getExecution());
  task.complete();
  return null;
}
