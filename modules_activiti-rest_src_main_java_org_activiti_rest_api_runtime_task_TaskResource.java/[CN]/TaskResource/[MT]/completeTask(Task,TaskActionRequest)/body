{
  if (actionRequest.getVariables() != null) {
    Map<String,Object> variablesToSet=new HashMap<String,Object>();
    for (    RestVariable var : actionRequest.getVariables()) {
      if (var.getName() == null) {
        throw new ActivitiIllegalArgumentException("Variable name is required");
      }
      Object actualVariableValue=getApplication(ActivitiRestServicesApplication.class).getRestResponseFactory().getVariableValue(var);
      variablesToSet.put(var.getName(),actualVariableValue);
    }
    ActivitiUtil.getTaskService().complete(task.getId(),variablesToSet);
  }
 else {
    ActivitiUtil.getTaskService().complete(task.getId());
  }
}
