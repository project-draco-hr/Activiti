{
  Map<String,Object> map=new HashMap<String,Object>();
  Iterator keys=jsonBody.keys();
  String key, typeKey, type;
  String[] keyPair;
  Object value;
  while (keys.hasNext()) {
    key=(String)keys.next();
    keyPair=key.split("_");
    if (keyPair.length == 1) {
      typeKey=keyPair[0] + "_type";
      if (jsonBody.has(typeKey)) {
        type=jsonBody.getString(typeKey);
        if (type.equals("Integer")) {
          value=jsonBody.getInt(key);
        }
 else         if (type.equals("Boolean")) {
          value=jsonBody.getBoolean(key);
        }
 else         if (type.equals("Date")) {
          value=jsonBody.getString(key);
        }
 else         if (type.equals("User")) {
          value=jsonBody.getString(key);
        }
 else         if (type.equals("String")) {
          value=jsonBody.getString(key);
        }
 else         if (type.equals("RepositoryFolder")) {
          value=jsonBody.getString(key);
        }
 else {
          throw new WebScriptException(Status.STATUS_BAD_REQUEST,"Parameter '" + keyPair[0] + "' is of unknown type '"+ type+ "'");
        }
      }
 else {
        value=jsonBody.get(key);
      }
      map.put(key,value);
    }
 else     if (keyPair.length == 2) {
      if (keyPair[1].equals("required")) {
        if (!jsonBody.has(keyPair[0]) || jsonBody.get(keyPair[0]) == null) {
          throw new WebScriptException(Status.STATUS_BAD_REQUEST,"Parameter '" + keyPair[0] + "' has no value");
        }
      }
    }
  }
  return map;
}
