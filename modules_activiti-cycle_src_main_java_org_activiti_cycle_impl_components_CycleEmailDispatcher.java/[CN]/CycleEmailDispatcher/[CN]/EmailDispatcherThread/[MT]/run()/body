{
  while (!isInterrupted()) {
    EmailDto mailDto=null;
    try {
      mailDto=emailQueue.take();
      Email email=new HtmlEmail();
      email.setFrom(mailDto.from);
      email.setMsg(mailDto.message);
      email.setSubject(mailDto.subject);
      email.addTo(mailDto.address);
      setMailServerProperties(email);
      email.send();
    }
 catch (    InterruptedException e) {
      return;
    }
catch (    Exception e) {
      logger.log(Level.SEVERE,"Could not send " + mailDto,e);
    }
  }
}
