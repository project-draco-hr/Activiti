{
  String nodeId=folderTemplate.getReferencedNodeId();
  String connectorId=folderTemplate.getConnectorId();
  RepositoryConnector connector=connectorList.getConnectorById(connectorId);
  RepositoryFolder parentFolder=connector.getRepositoryFolder(nodeId);
  RepositoryNodeCollection childNodeCollection=connector.getChildren(parentFolder.getNodeId());
  RepositoryFolder folderForThisProcessSolution=null;
  for (  RepositoryFolder folder : childNodeCollection.getFolderList()) {
    if (folder.getMetadata().getName().equals(getNameForFs())) {
      folderForThisProcessSolution=folder;
    }
  }
  if (folderForThisProcessSolution == null) {
    folderForThisProcessSolution=connector.createFolder(parentFolder.getNodeId(),getNameForFs());
  }
  RepositoryFolder actualFolder=connector.createFolder(folderForThisProcessSolution.getNodeId(),folderTemplate.getLabel());
  VirtualRepositoryFolderEntity entity=new VirtualRepositoryFolderEntity();
  entity.setLabel(folderTemplate.getLabel());
  entity.setConnectorId(connectorId);
  entity.setProcessSolutionId(processSolutionEntity.getId());
  entity.setReferencedNodeId(actualFolder.getNodeId());
  entity.setType(folderTemplate.getType());
  return entity;
}
