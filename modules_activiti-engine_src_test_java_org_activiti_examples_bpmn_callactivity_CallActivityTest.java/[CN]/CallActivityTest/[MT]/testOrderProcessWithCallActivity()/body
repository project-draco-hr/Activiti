{
  ProcessInstance pi=runtimeService.startProcessInstanceByKey("orderProcess");
  TaskQuery taskQuery=taskService.createTaskQuery();
  Task verifyCreditTask=taskQuery.singleResult();
  assertEquals("Verify credit history",verifyCreditTask.getName());
  ProcessInstance subProcessInstance=runtimeService.createProcessInstanceQuery().superProcessInstance(pi.getId()).singleResult();
  assertNotNull(subProcessInstance);
  assertEquals(pi.getId(),runtimeService.createProcessInstanceQuery().subProcessInstance(subProcessInstance.getId()).singleResult().getId());
  taskService.complete(verifyCreditTask.getId(),CollectionUtil.singletonMap("creditApproved",true));
  Task prepareAndShipTask=taskQuery.singleResult();
  assertEquals("Prepare and Ship",prepareAndShipTask.getName());
}
