{
  try {
    ByteArrayImpl formResourceByteArray=deployment.getResource(formReference);
    if (formResourceByteArray == null) {
      throw new ActivitiException("form '" + formReference + "' not available in "+ deployment);
    }
    byte[] formResourceBytes=formResourceByteArray.getBytes();
    String formString=new String(formResourceBytes);
    ELContext elContext=new TaskElContext(task);
    ValueExpression result=expressionFactory.createValueExpression(elContext,formString,String.class);
    return (String)result.getValue(elContext);
  }
 catch (  Exception e) {
    throw new ActivitiException("problem rendering template: " + e.getMessage(),e);
  }
}
