{
  ArrayList<String> list=new ArrayList<String>();
  list.add("one");
  list.add("two");
  HashMap<String,Object> variables=new HashMap<String,Object>();
  variables.put("list",list);
  String procId=runtimeService.startProcessInstanceByKey("parentProcess",variables).getId();
  Task task1=taskService.createTaskQuery().processVariableValueEquals("element","one").singleResult();
  Task task2=taskService.createTaskQuery().processVariableValueEquals("element","two").singleResult();
  assertNotNull(task1);
  assertNotNull(task2);
  HashMap<String,Object> subVariables=new HashMap<String,Object>();
  subVariables.put("x","y");
  completeTaskWithAct1591InMind(task1,subVariables);
  completeTaskWithAct1591InMind(task2,subVariables);
  Task task3=taskService.createTaskQuery().processDefinitionKey("midProcess").singleResult();
  assertNotNull(task3);
  completeTaskWithAct1591InMind(task3,null);
  Task task4=taskService.createTaskQuery().processDefinitionKey("parentProcess").singleResult();
  assertNotNull(task4);
  completeTaskWithAct1591InMind(task4,null);
  assertProcessEnded(procId);
}
