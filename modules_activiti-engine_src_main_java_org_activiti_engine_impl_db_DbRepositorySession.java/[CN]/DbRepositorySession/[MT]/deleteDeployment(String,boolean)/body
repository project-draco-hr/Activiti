{
  if (cascade) {
    CommandContext commandContext=CommandContext.getCurrent();
    List<ProcessDefinition> processDefinitions=new ProcessDefinitionQueryImpl().deploymentId(deploymentId).executeList(commandContext,null);
    boolean isHistoryEnabled=commandContext.getProcessEngineConfiguration().isHistoryEnabled();
    for (    ProcessDefinition processDefinition : processDefinitions) {
      if (isHistoryEnabled) {
        deleteHistoricProcessInstances(commandContext,processDefinition);
      }
      deleteProcessInstances(commandContext,processDefinition);
    }
  }
  dbSqlSession.delete("deleteProcessDefinitionsByDeploymentId",deploymentId);
  dbSqlSession.delete("deleteResourcesByDeploymentId",deploymentId);
  dbSqlSession.delete("deleteDeployment",deploymentId);
}
