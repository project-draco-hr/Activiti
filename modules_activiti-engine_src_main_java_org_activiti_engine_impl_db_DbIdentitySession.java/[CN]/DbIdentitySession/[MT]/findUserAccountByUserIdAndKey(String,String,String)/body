{
  IdentityInfoEntity identityInfoEntity=findUserInfoByUserIdAndKey(userId,key);
  if (identityInfoEntity == null) {
    return null;
  }
  Map<String,String> details=new HashMap<String,String>();
  String identityInfoId=identityInfoEntity.getId();
  List<IdentityInfoEntity> identityInfoDetails=findIdentityInfoDetails(identityInfoId);
  for (  IdentityInfoEntity identityInfoDetail : identityInfoDetails) {
    details.put(identityInfoDetail.getKey(),identityInfoDetail.getValue());
  }
  identityInfoEntity.setDetails(details);
  if (identityInfoEntity.getPasswordBytes() != null) {
    String password=decryptPassword(identityInfoEntity.getPasswordBytes(),userPassword);
    identityInfoEntity.setPassword(password);
  }
  return identityInfoEntity;
}
