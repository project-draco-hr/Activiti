{
  HistoricTaskInstanceQuery query=ActivitiUtil.getHistoryService().createHistoricTaskInstanceQuery();
  if (queryRequest.getTaskId() != null) {
    query.taskId(queryRequest.getTaskId());
  }
  if (queryRequest.getProcessInstanceId() != null) {
    query.processInstanceId(queryRequest.getProcessInstanceId());
  }
  if (queryRequest.getProcessBusinessKey() != null) {
    query.processInstanceBusinessKey(queryRequest.getProcessBusinessKey());
  }
  if (queryRequest.getProcessDefinitionKey() != null) {
    query.processDefinitionKey(queryRequest.getProcessDefinitionKey());
  }
  if (queryRequest.getProcessDefinitionId() != null) {
    query.processDefinitionId(queryRequest.getProcessDefinitionId());
  }
  if (queryRequest.getProcessDefinitionName() != null) {
    query.processDefinitionName(queryRequest.getProcessDefinitionName());
  }
  if (queryRequest.getExecutionId() != null) {
    query.executionId(queryRequest.getExecutionId());
  }
  if (queryRequest.getTaskName() != null) {
    query.taskName(queryRequest.getTaskName());
  }
  if (queryRequest.getTaskNameLike() != null) {
    query.taskNameLike(queryRequest.getTaskNameLike());
  }
  if (queryRequest.getTaskDescription() != null) {
    query.taskDescription(queryRequest.getTaskDescription());
  }
  if (queryRequest.getTaskDescriptionLike() != null) {
    query.taskDescriptionLike(queryRequest.getTaskDescriptionLike());
  }
  if (queryRequest.getTaskDefinitionKey() != null) {
    query.taskDefinitionKey(queryRequest.getTaskDefinitionKey());
  }
  if (queryRequest.getTaskDeleteReason() != null) {
    query.taskDeleteReason(queryRequest.getTaskDeleteReason());
  }
  if (queryRequest.getTaskDeleteReasonLike() != null) {
    query.taskDeleteReasonLike(queryRequest.getTaskDeleteReasonLike());
  }
  if (queryRequest.getTaskAssignee() != null) {
    query.taskAssignee(queryRequest.getTaskAssignee());
  }
  if (queryRequest.getTaskAssigneeLike() != null) {
    query.taskAssigneeLike(queryRequest.getTaskAssigneeLike());
  }
  if (queryRequest.getTaskOwner() != null) {
    query.taskOwner(queryRequest.getTaskOwner());
  }
  if (queryRequest.getTaskOwnerLike() != null) {
    query.taskOwnerLike(queryRequest.getTaskOwnerLike());
  }
  if (queryRequest.getTaskInvolvedUser() != null) {
    query.taskInvolvedUser(queryRequest.getTaskInvolvedUser());
  }
  if (queryRequest.getTaskPriority() != null) {
    query.taskPriority(queryRequest.getTaskPriority());
  }
  if (queryRequest.getFinished() != null) {
    if (queryRequest.getFinished()) {
      query.finished();
    }
 else {
      query.unfinished();
    }
  }
  if (queryRequest.getProcessFinished() != null) {
    if (queryRequest.getProcessFinished()) {
      query.processFinished();
    }
 else {
      query.processUnfinished();
    }
  }
  if (queryRequest.getParentTaskId() != null) {
    query.taskParentTaskId(queryRequest.getParentTaskId());
  }
  if (queryRequest.getDueDate() != null) {
    query.taskDueDate(queryRequest.getDueDate());
  }
  if (queryRequest.getDueDateAfter() != null) {
    query.taskDueAfter(queryRequest.getDueDateAfter());
  }
  if (queryRequest.getDueDateBefore() != null) {
    query.taskDueBefore(queryRequest.getDueDateBefore());
  }
  if (queryRequest.getTaskCreatedOn() != null) {
    query.taskCreatedOn(queryRequest.getTaskCreatedOn());
  }
  if (queryRequest.getTaskVariables() != null) {
    addTaskVariables(query,queryRequest.getTaskVariables());
  }
  if (queryRequest.getProcessVariables() != null) {
    addProcessVariables(query,queryRequest.getProcessVariables());
  }
  return new HistoricTaskInstancePaginateList(this).paginateList(urlQuery,query,"taskInstanceId",allowedSortProperties);
}
