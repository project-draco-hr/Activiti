{
  ProcessDefinition processDefinition=repositoryService.createProcessDefinitionQuery().processDefinitionKey("oneTaskProcess").singleResult();
  assertNotNull(processDefinition);
  repositoryService.addCandidateStarterUser(processDefinition.getId(),"kermit");
  repositoryService.addCandidateStarterGroup(processDefinition.getId(),"sales");
  assertEquals(2,identityLinkListener.getEventsReceived().size());
  ActivitiEntityEvent event=(ActivitiEntityEvent)identityLinkListener.getEventsReceived().get(0);
  assertEquals(ActivitiEventType.ENTITY_CREATED,event.getType());
  assertTrue(event.getEntity() instanceof IdentityLink);
  event=(ActivitiEntityEvent)identityLinkListener.getEventsReceived().get(1);
  assertEquals(ActivitiEventType.ENTITY_CREATED,event.getType());
  assertTrue(event.getEntity() instanceof IdentityLink);
  identityLinkListener.clearEventsReceived();
  repositoryService.deleteCandidateStarterUser(processDefinition.getId(),"kermit");
  repositoryService.deleteCandidateStarterGroup(processDefinition.getId(),"sales");
  assertEquals(2,identityLinkListener.getEventsReceived().size());
  event=(ActivitiEntityEvent)identityLinkListener.getEventsReceived().get(0);
  assertEquals(ActivitiEventType.ENTITY_DELETED,event.getType());
  assertTrue(event.getEntity() instanceof IdentityLink);
  event=(ActivitiEntityEvent)identityLinkListener.getEventsReceived().get(1);
  assertEquals(ActivitiEventType.ENTITY_DELETED,event.getType());
  assertTrue(event.getEntity() instanceof IdentityLink);
}
