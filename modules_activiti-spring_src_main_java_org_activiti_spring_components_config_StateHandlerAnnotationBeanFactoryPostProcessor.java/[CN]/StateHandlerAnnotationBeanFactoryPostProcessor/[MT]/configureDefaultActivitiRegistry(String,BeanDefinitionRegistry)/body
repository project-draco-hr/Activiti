{
  if (!beanAlreadyConfigured(registry,registryBeanName,StateHandlerRegistry.class)) {
    String registryName=StateHandlerRegistry.class.getName();
    log.info("registering a {} instance under bean name {}.",registryName,ActivitiContextUtils.ACTIVITI_REGISTRY_BEAN_NAME);
    RootBeanDefinition rootBeanDefinition=new RootBeanDefinition();
    rootBeanDefinition.setBeanClassName(registryName);
    rootBeanDefinition.getPropertyValues().addPropertyValue("processEngine",this.processEngine);
    BeanDefinitionHolder holder=new BeanDefinitionHolder(rootBeanDefinition,registryBeanName);
    BeanDefinitionReaderUtils.registerBeanDefinition(holder,registry);
  }
}
