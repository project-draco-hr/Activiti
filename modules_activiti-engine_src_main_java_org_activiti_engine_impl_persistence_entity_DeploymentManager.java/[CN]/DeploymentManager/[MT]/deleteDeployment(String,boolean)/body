{
  if (cascade) {
    List<ProcessDefinition> processDefinitions=getDbSqlSession().createProcessDefinitionQuery().deploymentId(deploymentId).list();
    for (    ProcessDefinition processDefinition : processDefinitions) {
      String processDefinitionId=processDefinition.getId();
      getProcessInstanceManager().deleteProcessInstancesByProcessDefinition(processDefinitionId,"deleted deployment",cascade);
      Context.getProcessEngineConfiguration().getDeploymentCache().removeProcessDefinition(processDefinitionId);
    }
  }
  getProcessDefinitionManager().deleteProcessDefinitionsByDeploymentId(deploymentId);
  getResourceManager().deleteResourcesByDeploymentId(deploymentId);
  getDbSqlSession().delete("deleteDeployment",deploymentId);
}
