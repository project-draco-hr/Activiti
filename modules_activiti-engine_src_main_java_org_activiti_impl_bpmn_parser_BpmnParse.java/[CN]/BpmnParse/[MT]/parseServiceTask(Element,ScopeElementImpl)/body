{
  ActivityImpl activity=parseAndCreateActivityOnScopeElement(serviceTaskElement,scopeElement);
  String operationRef=serviceTaskElement.attribute("operationRef");
  if (operationRef != null) {
    Operation operation=getOperation(operationRef);
    if (operation != null) {
      BpmnInterface bpmnInterface=operation.getInterface();
      String className=bpmnInterface.getName();
      String method=operation.getName();
      activity.setActivityBehavior(new JavaServiceTaskActivity(className,method));
    }
 else {
      throw new ActivitiException("Invalid operationReference on line " + serviceTaskElement.getLine() + ": operation '"+ operationRef+ "' not found");
    }
  }
 else {
    throw new ActivitiException("Line " + serviceTaskElement.getLine() + ": The attribute operationRef on a serviceTask is required");
  }
}
