{
  if (cascade) {
    CommandContext commandContext=CommandContext.getCurrent();
    List<ProcessDefinition> processDefinitions=new ProcessDefinitionQueryImpl().deploymentId(deploymentId).executeList(commandContext,null);
    for (    ProcessDefinition processDefinition : processDefinitions) {
      List<Execution> processInstances=new ExecutionQueryImpl().onlyProcessInstances().processDefinitionId(processDefinition.getId()).executeList(commandContext,null);
      for (      Execution processInstance : processInstances) {
        commandContext.getRuntimeSession().endProcessInstance(processInstance.getId(),"deleted deployment");
      }
    }
  }
  dbSqlSession.delete("deleteProcessDefinitionsByDeploymentId",deploymentId);
  dbSqlSession.delete("deleteResourcesByDeploymentId",deploymentId);
  dbSqlSession.delete("deleteDeployment",deploymentId);
}
