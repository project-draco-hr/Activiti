{
  ExecutionImpl processInstance=newProcessInstance();
  processInstance.setProcessDefinition(this);
  processInstance.setProcessInstance(processInstance);
  processInstance.initialize();
  ExecutionImpl scopeInstance=processInstance;
  List<ActivityImpl> initialActivities=getInitialActivityStack();
  for (  ActivityImpl initialActivity : initialActivities) {
    if (initialActivity.isScope()) {
      scopeInstance=scopeInstance.createExecution();
      scopeInstance.setActivity(initialActivity);
      if (initialActivity.isScope()) {
        scopeInstance.initialize();
      }
    }
  }
  scopeInstance.setActivity(initial);
  return processInstance;
}
