{
  ProcessInstance processInstance=runtimeService.startProcessInstanceByKey("eventListenersProcess");
  String varSetInEventListener=(String)runtimeService.getVariable(processInstance.getId(),"variableSetInEventListener");
  String eventNameReceived=(String)runtimeService.getVariable(processInstance.getId(),"eventNameReceived");
  assertNotNull(varSetInEventListener);
  assertEquals("firstValue",varSetInEventListener);
  assertNotNull(eventNameReceived);
  assertEquals("start",eventNameReceived);
  Task task=taskService.createTaskQuery().processInstanceId(processInstance.getId()).singleResult();
  assertNotNull(task);
  taskService.complete(task.getId());
  varSetInEventListener=(String)runtimeService.getVariable(processInstance.getId(),"variableSetInEventListener");
  eventNameReceived=(String)runtimeService.getVariable(processInstance.getId(),"eventNameReceived");
  assertNotNull(varSetInEventListener);
  assertEquals("secondValue",varSetInEventListener);
  assertNotNull(eventNameReceived);
  assertEquals("take",eventNameReceived);
  ExampleEventListenerPojo myPojo=new ExampleEventListenerPojo();
  runtimeService.setVariable(processInstance.getId(),"myPojo",myPojo);
  task=taskService.createTaskQuery().processInstanceId(processInstance.getId()).singleResult();
  assertNotNull(task);
  taskService.complete(task.getId());
  ExampleEventListenerPojo pojoVariable=(ExampleEventListenerPojo)runtimeService.getVariable(processInstance.getId(),"myPojo");
  assertNotNull(pojoVariable.getReceivedEventName());
  assertEquals("end",pojoVariable.getReceivedEventName());
  task=taskService.createTaskQuery().processInstanceId(processInstance.getId()).singleResult();
  assertNotNull(task);
  taskService.complete(task.getId());
  assertProcessEnded(processInstance.getId());
}
