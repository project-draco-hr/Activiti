{
  ProcessInstance pi=deployer.getProcessService().startProcessInstanceByKey("twoSubProcessInParallel");
  TaskQuery taskQuery=deployer.getTaskService().createTaskQuery().processInstance(pi.getId()).orderAsc(TaskQuery.PROPERTY_NAME);
  List<Task> tasks=taskQuery.list();
  Task taskA=tasks.get(0);
  Task taskB=tasks.get(1);
  assertEquals("Task in subprocess A",taskA.getName());
  assertEquals("Task in subprocess B",taskB.getName());
  deployer.getTaskService().complete(taskA.getId());
  deployer.getTaskService().complete(taskB.getId());
  tasks=taskQuery.list();
  taskA=tasks.get(0);
  taskB=tasks.get(1);
  assertEquals("Task after subprocess A",taskA.getName());
  assertEquals("Task after subprocess B",taskB.getName());
  deployer.getTaskService().complete(taskA.getId());
  deployer.getTaskService().complete(taskB.getId());
  deployer.assertProcessEnded(pi.getId());
}
