{
  for (  Shape shape : diagram.getShapes()) {
    Map<String,String> properties=shape.getProperties();
    if (properties.containsKey("name")) {
      String oldName=properties.get("name");
      String newName=transformName(oldName);
      if (!newName.equals(oldName)) {
        setOriginalName(shape,oldName);
        properties.put("name",newName);
      }
    }
  }
  return diagram;
}
