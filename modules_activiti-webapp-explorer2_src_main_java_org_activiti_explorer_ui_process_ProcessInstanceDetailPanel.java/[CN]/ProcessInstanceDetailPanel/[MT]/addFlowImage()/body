{
  ProcessDefinitionEntity processDefinitionEntity=(ProcessDefinitionEntity)((RepositoryServiceImpl)repositoryService).getDeployedProcessDefinition(processDefinition.getId());
  if (processDefinitionEntity != null && processDefinitionEntity.isGraphicalNotationDefined()) {
    Label header=new Label(i18nManager.getMessage(Messages.PROCESS_INSTANCE_HEADER_DIAGRAM));
    header.addStyleName(ExplorerLayout.STYLE_DETAIL_BLOCK);
    header.addStyleName(ExplorerLayout.STYLE_H3);
    verticalLayout.addComponent(header);
    StreamResource diagram=new ProcessDefinitionImageStreamResourceBuilder().buildStreamResource(processInstance,repositoryService,runtimeService);
    Embedded embedded=new Embedded("",diagram);
    embedded.setType(Embedded.TYPE_IMAGE);
    verticalLayout.addComponent(embedded);
  }
}
