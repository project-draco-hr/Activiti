{
  for (int i=0; i < nodeList.getLength(); i++) {
    Node currentNode=nodeList.item(i);
    if (!(currentNode instanceof Element)) {
      continue;
    }
    Element currentElement=(Element)currentNode;
    String nameAttribute=null;
    String valueAttribute=null;
    if ("input".equals(currentElement.getTagName())) {
      if ("text".equals(currentElement.getAttribute("type"))) {
        nameAttribute=currentElement.getAttribute("name");
        valueAttribute=currentElement.getAttribute("value");
      }
 else       if ("checkbox".equals(currentElement.getAttribute("type"))) {
        nameAttribute=currentElement.getAttribute("name");
        valueAttribute=currentElement.getAttribute("property");
      }
 else       if ("hidden".equals(currentElement.getAttribute("type"))) {
        nameAttribute=currentElement.getAttribute("name");
        valueAttribute=currentElement.getAttribute("value");
      }
    }
    if ("output".equals(currentElement.getTagName())) {
      nameAttribute=currentElement.getAttribute("value");
      valueAttribute=currentElement.getAttribute("value");
    }
    if ("checkbox".equals(currentElement.getTagName())) {
      nameAttribute=currentElement.getAttribute("name");
      valueAttribute=currentElement.getAttribute("property");
    }
    if (nameAttribute == null || nameAttribute.length() == 0 || valueAttribute == null) {
      continue;
    }
    if (!valueAttribute.matches("\\$\\{.*\\}")) {
      continue;
    }
    if (expressionMap.containsKey(nameAttribute)) {
      throw new RuntimeException("Form contains a property with name '" + nameAttribute + "' more than once.");
    }
    expressionMap.put(nameAttribute,valueAttribute);
  }
}
