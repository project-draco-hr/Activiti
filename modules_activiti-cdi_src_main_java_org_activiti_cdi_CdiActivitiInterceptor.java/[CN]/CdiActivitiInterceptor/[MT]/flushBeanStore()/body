{
  BusinessProcessAssociationManager associationManager=getAssociationManager();
  String executionId=associationManager.getProcessInstanceId();
  if (executionId != null) {
    ExecutionEntity processInstance=Context.getCommandContext().getExecutionManager().findExecutionById(executionId);
    if (processInstance != null && !processInstance.isEnded()) {
      CachingBeanStore beanStore=associationManager.getBeanStore();
      if (log.isLoggable(Level.FINE)) {
        logFlushSummary(beanStore);
      }
      processInstance.setVariables(beanStore.getAll());
      beanStore.clear();
    }
  }
}
