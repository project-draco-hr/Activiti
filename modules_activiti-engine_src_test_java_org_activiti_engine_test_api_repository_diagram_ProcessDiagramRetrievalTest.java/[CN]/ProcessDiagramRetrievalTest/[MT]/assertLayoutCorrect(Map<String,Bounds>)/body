{
  String html=generateHtmlCode(imageFileName,processDiagramLayout,highlightedActivityId);
  File htmlFile=new File("src/test/resources/org/activiti/engine/test/api/repository/diagram/" + imageFileName + ".html");
  if (OVERWRITE_EXPECTED_HTML_FILES) {
    FileUtils.writeStringToFile(htmlFile,html);
    fail("The assertions of this test only work if ProcessDiagramRetrievalTest#OVERWRITE_EXPECTED_HTML_FILES is set to false.");
  }
  assertEquals(FileUtils.readFileToString(htmlFile).replace("\r",""),html);
}
