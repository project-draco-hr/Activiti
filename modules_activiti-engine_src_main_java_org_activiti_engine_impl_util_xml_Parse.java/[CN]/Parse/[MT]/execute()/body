{
  try {
    InputStream inputStream=streamSource.getInputStream();
    if (schemaResource != null) {
      SchemaFactory factory=SchemaFactory.newInstance(XMLConstants.W3C_XML_SCHEMA_NS_URI);
      Schema schema=factory.newSchema(Thread.currentThread().getContextClassLoader().getResource(schemaResource));
      parser.getSaxParserFactory().setSchema(schema);
      Validator validator=schema.newValidator();
      validator.validate(new javax.xml.transform.stream.StreamSource(inputStream));
      inputStream.reset();
    }
    SAXParser saxParser=parser.getSaxParser();
    saxParser.parse(inputStream,new ParseHandler(this));
  }
 catch (  Exception e) {
    throw new ActivitiException("couldn't parse " + streamSource + ": "+ e.getMessage(),e);
  }
  return this;
}
