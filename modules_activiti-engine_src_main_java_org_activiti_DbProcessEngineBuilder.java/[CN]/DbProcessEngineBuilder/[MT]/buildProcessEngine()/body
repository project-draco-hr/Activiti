{
  if (dataBaseName == null) {
    throw new ActivitiException("no database name specified (used to look up queries and scripts)");
  }
  ProcessEngineFactory factory=new ProcessEngineFactory();
  factory.setProcessEngineName(processEngineName);
  factory.setDbSchemaStrategy(dbSchemaStrategy);
  factory.setJobExecutorAutoActivate(jobExecutorAutoActivate);
  if (jdbcDriver == null) {
    throw new ActivitiException("no jdbc driver specified");
  }
  if (jdbcUrl == null) {
    throw new ActivitiException("no jdbc url specified");
  }
  if (jdbcUsername == null) {
    throw new ActivitiException("no jdbc username specified");
  }
  if (jdbcPassword == null) {
    throw new ActivitiException("no jdbc password specified");
  }
  DataSource dataSource=new PooledDataSource(Thread.currentThread().getContextClassLoader(),jdbcDriver,jdbcUrl,jdbcUsername,jdbcPassword);
  factory.setDataSource(dataSource);
  factory.setDataBaseName(dataBaseName);
  factory.setLocalTransactions(localTransactions);
  return factory.createProcessEngine();
}
