{
  Map<String,byte[]> files=new HashMap<String,byte[]>();
  if (LOGGER.isLoggable(Level.INFO)) {
    LOGGER.info("Deploying resources in " + packageName);
  }
  String processDefinitionPath=packageName + "/processdefinition.xml";
  files.put("processdefinition.xml",readProcessResource(processDefinitionPath,true));
  String gpdPath=packageName + "/gpd.xml";
  byte[] gpdBytes=readProcessResource(gpdPath,false);
  if (gpdBytes != null) {
    if (LOGGER.isLoggable(Level.INFO)) {
      LOGGER.info("gpd.xml available in " + packageName);
    }
    files.put("gpd.xml",gpdBytes);
  }
  String imagePath=packageName + "/processimage.jpg";
  byte[] imageBytes=readProcessResource(imagePath,false);
  if (imageBytes != null) {
    if (LOGGER.isLoggable(Level.INFO)) {
      LOGGER.info("processimage.jpg available in " + packageName);
    }
    files.put("processimage.jpg",imageBytes);
  }
  try {
    ProcessDefinition processDefinition=ProcessDefinition.parseParZipInputStream(ZipUtil.createZipInputStream(files));
    jbpmContext.deployProcessDefinition(processDefinition);
    return processDefinition.getName();
  }
 catch (  IOException e) {
    throw new ActivitiException("Couldn't create zip file",e);
  }
}
