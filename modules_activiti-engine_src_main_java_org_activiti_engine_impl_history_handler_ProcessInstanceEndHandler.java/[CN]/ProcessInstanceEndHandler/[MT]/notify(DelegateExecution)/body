{
  HistoricProcessInstanceEntity historicProcessInstance=Context.getCommandContext().getHistoricProcessInstanceManager().findHistoricProcessInstance(execution.getProcessInstanceId());
  if (historicProcessInstance != null) {
    String deleteReason=((ExecutionEntity)execution).getDeleteReason();
    historicProcessInstance.markEnded(deleteReason);
    historicProcessInstance.setEndActivityId(((ExecutionEntity)execution).getActivityId());
  }
}
