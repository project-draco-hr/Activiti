{
  String representationId=req.getString("representationId");
  RepositoryArtifact artifact=repositoryService.getRepositoryArtifact(req.getMandatoryString("connectorId"),req.getString("nodeId"));
  try {
    model.put("connectorId",artifact.getConnectorId());
    model.put("nodeId",artifact.getNodeId());
    ContentRepresentation contentRepresentation=contentService.getContentRepresentation(artifact,representationId);
switch (contentRepresentation.getRenderInfo()) {
case IMAGE:
case HTML:
      break;
case HTML_REFERENCE:
case BINARY:
case CODE:
case TEXT_PLAIN:
    String content=contentRepresentation.getContent(artifact).asString();
  model.put("content",content);
}
model.put("renderInfo",contentRepresentation.getRenderInfo().name());
model.put("contentRepresentationId",contentRepresentation.getId());
model.put("contentType",contentRepresentation.getRepresentationMimeType().getContentType());
}
 catch (TransformationException e) {
model.put("renderInfo",RenderInfo.HTML);
model.put("contentRepresentationId",representationId);
model.put("contentType",CycleApplicationContext.get(HtmlMimeType.class).getContentType());
}
}
