{
  String processDefinitonKey=this.processDefinitonKey;
  if (processDefinitionExpression != null) {
    processDefinitonKey=(String)processDefinitionExpression.getValue(execution);
  }
  ProcessDefinitionEntity processDefinition=null;
  if (execution.getTenantId() == null || ProcessEngineConfiguration.NO_TENANT_ID.equals(execution.getTenantId())) {
    processDefinition=Context.getProcessEngineConfiguration().getDeploymentManager().findDeployedLatestProcessDefinitionByKey(processDefinitonKey);
  }
 else {
    processDefinition=Context.getProcessEngineConfiguration().getDeploymentManager().findDeployedLatestProcessDefinitionByKeyAndTenantId(processDefinitonKey,execution.getTenantId());
  }
  if (processDefinition.isSuspended()) {
    throw new ActivitiException("Cannot start process instance. Process definition " + processDefinition.getName() + " (id = "+ processDefinition.getId()+ ") is suspended");
  }
  PvmProcessInstance subProcessInstance=execution.createSubProcessInstance(processDefinition);
  for (  AbstractDataAssociation dataInputAssociation : dataInputAssociations) {
    Object value=null;
    if (dataInputAssociation.getSourceExpression() != null) {
      value=dataInputAssociation.getSourceExpression().getValue(execution);
    }
 else {
      value=execution.getVariable(dataInputAssociation.getSource());
    }
    subProcessInstance.setVariable(dataInputAssociation.getTarget(),value);
  }
  try {
    subProcessInstance.start();
  }
 catch (  Exception e) {
    if (!ErrorPropagation.mapException(e,execution,mapExceptions,true))     throw e;
  }
}
