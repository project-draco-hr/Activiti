{
  runtimeService.startProcessInstanceByKey("catchSignal");
  assertEquals(1,runtimeService.createEventSubscriptionQuery().count());
  assertEquals(1,runtimeService.createProcessInstanceQuery().count());
  runtimeService.startProcessInstanceByKey("throwSignal");
  assertEquals(1,runtimeService.createEventSubscriptionQuery().count());
  assertEquals(1,runtimeService.createProcessInstanceQuery().count());
  assertEquals(1,managementService.createJobQuery().count());
  try {
    ClockUtil.setCurrentTime(new Date(System.currentTimeMillis() + 1000));
    waitForJobExecutorToProcessAllJobs(10000,100l);
    assertEquals(0,runtimeService.createEventSubscriptionQuery().count());
    assertEquals(0,runtimeService.createProcessInstanceQuery().count());
    assertEquals(0,managementService.createJobQuery().count());
  }
  finally {
    ClockUtil.setCurrentTime(new Date());
  }
}
