{
  try {
    Class<?> theClass=null;
    FieldExtension behaviorExtension=null;
    for (    FieldExtension fieldExtension : fieldExtensions) {
      if ("camelBehaviorClass".equals(fieldExtension.getFieldName()) && StringUtils.isNotEmpty(fieldExtension.getStringValue())) {
        theClass=Class.forName(fieldExtension.getStringValue());
        behaviorExtension=fieldExtension;
        break;
      }
    }
    if (behaviorExtension != null) {
      fieldExtensions.remove(behaviorExtension);
    }
    if (theClass == null) {
      theClass=Class.forName("org.activiti.camel.impl.CamelBehaviorDefaultImpl");
    }
    List<FieldDeclaration> fieldDeclarations=createFieldDeclarations(fieldExtensions);
    return (ActivityBehavior)ClassDelegate.instantiateDelegate(theClass,fieldDeclarations);
  }
 catch (  ClassNotFoundException e) {
    bpmnModel.addProblem("Could not find org.activiti.camel.CamelBehavior: " + e.getMessage(),task);
    return null;
  }
}
